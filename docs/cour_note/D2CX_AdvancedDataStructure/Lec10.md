# Lecture 10 | NP Completeness

!!! info "å¯¼è¯»"
    ç”±äºæœ¬èŠ‚æ¶‰åŠè¾ƒå¤šæ¦‚å¿µï¼Œå¹¶ä¸”çŸ¥è¯†æ ‘é•¿çš„å¾ˆè“¬æ¾ï¼Œæ‰€ä»¥æˆ‘å†³å®šå°è¯•éçº¿æ€§ç»„ç»‡å†…å®¹ï¼Œå› æ­¤æœ¬æ–‡çš„é˜…è¯»é¡ºåºå¯èƒ½ä¹Ÿå¹¶ä¸ä¼šæ˜¯çº¿æ€§çš„ã€‚
    
    æ‰€æœ‰æåˆ°çš„ã€å¹¶ä¸”æœ¬æ–‡ä¼šä»‹ç»çš„ç›¸å…³å†…å®¹ï¼Œéƒ½ä¼šä»¥**[é“¾æ¥å’Œæ”¾å¤§é•œğŸ”](#lecture-10--np-completeness)**çš„å½¢å¼å‡ºç°ã€‚æ¨èä½¿ç”¨é¼ æ ‡ä¸­é”®ç­‰æ‰“å¼€æ–°æ ‡ç­¾é¡µæŸ¥çœ‹ï¼Œæ–¹ä¾¿å›æº¯ã€‚

    å› æ­¤æ¨èçš„é˜…è¯»é¡ºåºæ˜¯ï¼Œé¡ºç€è¯»ä¸‹å»ï¼Œæ¯æ¬¡å‡ºç° ğŸ” éƒ½è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢å¼çš„å­¦ä¹ ï¼Œç›´è‡³çœ‹å®Œå…¨æ–‡ã€‚

    å…¶ä¸­ï¼Œåœ¨ **[ç›¸å…³æ¦‚å¿µ](#ç›¸å…³æ¦‚å¿µ)** ä¹‹åçš„éƒ¨åˆ†ï¼Œæˆ‘ä¼šä¿è¯åœ¨å‰é¢éƒ½æœ‰æåŠï¼Œè€Œå…¶ä¹‹å‰çš„å†…å®¹ï¼Œæ¨èéƒ½åœ¨é¡ºåºé˜…è¯»ä¸­æ¶‰åŠã€‚
    
## æ¦‚è¿°

!!! quote "Links"
    OI Wiki: https://oi-wiki.org/misc/cc-basic/

    Wikipedia: https://en.wikipedia.org/wiki/P_versus_NP_problem

    Wikipedia: https://en.wikipedia.org/wiki/NP-completeness

    Wikipedia: https://en.wikipedia.org/wiki/NP-hardness

æ ¹æ®é—®é¢˜çš„éš¾åº¦ï¼Œç”±ä¸åŒçš„å®šä¹‰åˆ’åˆ†ï¼Œé—®é¢˜å¯ä»¥åˆ†ä¸ºï¼š

**P** é—®é¢˜(polynomial time)ã€**NP** é—®é¢˜(nondeterministic polynomial time)ã€**NPC** é—®é¢˜(NP complete)ã€**NPH** é—®é¢˜(NP hard)ã€‚é™¤æ­¤ä¹‹å¤– ï¼Œæˆ‘ä»¬è¿˜éœ€è¦é¢å¤–äº†è§£ä¸å¯è®¡ç®—é—®é¢˜(undecidable)ã€‚

ç”±äºä¸å¯è®¡ç®—é—®é¢˜æ¯”è¾ƒç‰¹æ®Šï¼Œæ‰€ä»¥æˆ‘å…ˆæ”¾åœ¨å‰é¢ä»‹ç»ã€‚

??? definition "Undecidable Problem"

    !!! quote "Links"
        Wikipedia: https://en.wikipedia.org/wiki/Undecidable_problem

    **ä¸å¯åˆ¤å®šé—®é¢˜(undecidable problem)**æ˜¯ä¸€ç±»ç‰¹æ®Šçš„[å†³å®šæ€§é—®é¢˜](https://en.wikipedia.org/wiki/Decision_problem)ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯æˆ‘ä»¬æ— æ³•è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥æ±‚è§£å®ƒçš„ç»“æœã€‚

    å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒå…¸å‹çš„ä¾‹å­å°±æ˜¯**[åœæœºé—®é¢˜ğŸ”](#halting-problem)**ã€‚

æˆ‘ä»¬å¯ä»¥ç”¨è¿™æ ·ä¸€å¼ å›¾æ¥è¡¨ç¤ºå…¶ä»–å‡ ä¸ªæ¦‚å¿µçš„å…³ç³»ï¼š

<center>
    ![](img/63.png){ width=60% }
</center>

> Source: https://en.wikipedia.org/wiki/NP-hardness

å¯ä»¥ç²—æµ…çš„æŒ‰ç…§å›¾ä¸­çš„â€œComplexityâ€è½´æ¥ç†è§£å…¶ä¸­çš„è½¬åŒ–å…³ç³»ï¼Œæ¥ä¸‹æ¥ç»™å‡ºå®ƒä»¬çš„è¯¦ç»†å®šä¹‰ï¼š

!!! definition "P"
    P å–è‡ª polynomial timeï¼ŒæŒ‡çš„æ˜¯å¯ä»¥ç”¨**[ç¡®å®šå‹å›¾çµæœºğŸ”](#å›¾çµæœº)**åœ¨**å¤šé¡¹å¼**æ—¶é—´å†…**è§£å†³**çš„é—®é¢˜ã€‚
    
    ä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸‹æ‰€è¯´çš„ï¼Œå¯ä»¥åœ¨**å¤šé¡¹å¼**æ—¶é—´å†…**è§£å†³**çš„é—®é¢˜ã€‚

!!! definition "NP"
    NP å³ nondeterministic polynomial timeï¼ŒæŒ‡çš„æ˜¯å¯ä»¥ç”¨**[éç¡®å®šå‹å›¾çµæœºğŸ”](#å›¾çµæœº)**åœ¨**å¤šé¡¹å¼**æ—¶é—´å†…**è§£å†³**çš„é—®é¢˜ã€‚è¿™ä¸ªè¯´æ³•ç­‰ä»·äºå¯ä»¥ç”¨**[ç¡®å®šå‹å›¾çµæœºğŸ”](#å›¾çµæœº)**åœ¨**å¤šé¡¹å¼**æ—¶é—´å†…**éªŒè¯**ï¼ˆåˆ¤æ–­ç­”æ¡ˆæ˜¯å¦æ­£ç¡®ï¼‰ã€‚
    
    ä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸‹æ‰€è¯´çš„ï¼Œå¯ä»¥åœ¨**å¤šé¡¹å¼**æ—¶é—´å†…**éªŒè¯**çš„é—®é¢˜ã€‚

!!! definition "NPC"
    NPC å³ NP completeï¼ŒNP å®Œå…¨ï¼Œæ˜¯ NP ä¸­æœ€éš¾çš„**å†³å®šæ€§**é—®é¢˜ï¼ˆå¹¶ä¸æ˜¯æ— é™å®šè¯çš„æœ€éš¾çš„é—®é¢˜ï¼ï¼‰ã€‚è€Œæˆ‘ä»¬ç§°æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„é—®é¢˜ä¸º NPC é—®é¢˜ï¼š

    1. æ˜¯ä¸€ä¸ª NP é—®é¢˜ï¼›
    2. æ‰€æœ‰ NP é—®é¢˜éƒ½å¯ä»¥**[å¤šé¡¹å¼æ—¶é—´å½’çº¦ğŸ”](#å¤šé¡¹å¼æ—¶é—´å½’çº¦)**ä¸ºè¯¥é—®é¢˜ï¼›

    ç”± 2 å¯ä»¥æœ‰ç»“è®ºï¼Œæ‰€æœ‰çš„ NPC é—®é¢˜éš¾åº¦ç›¸åŒâ€”â€”ä¸€æ—¦æœ‰ä¸€ä¸ª NPC é—®é¢˜è¢«è§£å†³ï¼Œé‚£ä¹ˆæ‰€æœ‰ NPC é—®é¢˜ï¼Œä¹ƒè‡³æ‰€æœ‰ NP é—®é¢˜éƒ½èƒ½è¢«è§£å†³ã€‚

    å¦‚æœæˆ‘ä»¬è¯•å›¾è¯æ˜ä¸€ä¸ªé—®é¢˜æ˜¯ NPC é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ç§æ‰‹æ®µï¼š

    1. åˆ¤å®šè¯¥é—®é¢˜æ˜¯ä¸€ä¸ª NP é—®é¢˜ï¼›
    2. åˆ¤å®šä¸€ä¸ªå·²çŸ¥çš„ NPC é—®é¢˜å¯ä»¥**[å¤šé¡¹å¼æ—¶é—´å½’çº¦ğŸ”](#å¤šé¡¹å¼æ—¶é—´å½’çº¦)**ä¸ºè¯¥é—®é¢˜ï¼›

    > ç¬¬ä¸€ä¸ªè¢«è¯æ˜æ˜¯ NPC çš„é—®é¢˜æ˜¯ **[Circuit-SATğŸ”](#circuit-sat)** é—®é¢˜ã€‚

!!! extra "P ?= NP & NPC"
    å…³äº P å’Œ NP çš„å…³ç³»ï¼Œæˆ‘ä»¬ä»ç„¶ä¸çŸ¥é“ P æ˜¯å¦èƒ½ç­‰äº NPï¼Œå³æˆ‘ä»¬ä»ç„¶ä¸çŸ¥é“æ˜¯å¦å­˜åœ¨å¤šé¡¹å¼ç®—æ³•å¯ä»¥è§£å†³ä¸€åˆ‡ NP é—®é¢˜ã€‚

    è€Œå…¶ä¸­çš„å…³é”®å°±æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ° NPC é—®é¢˜çš„å¤šé¡¹å¼è§£æ³•ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¯æ˜ P = NPã€‚

!!! definition "NPH"
    NPH å³ NP hardï¼ŒNP å›°éš¾ï¼Œå®ƒä¸ä¸€å®šéœ€è¦æ˜¯ NP é—®é¢˜ã€‚è€Œæ‰€æœ‰ NP é—®é¢˜éƒ½å¯ä»¥**[å¤šé¡¹å¼æ—¶é—´å½’çº¦ğŸ”](#å¤šé¡¹å¼æ—¶é—´å½’çº¦)**ä¸º NPH é—®é¢˜ã€‚

---

## è¯¾å†…æ¡ˆä¾‹

### Halting Problem

!!! quote "Links"
    Wikipedia: https://en.wikipedia.org/wiki/Halting_problem

åœæœºé—®é¢˜æ˜¯ä¸€ä¸ªå…¸å‹çš„ä¸å¯è®¡ç®—é—®é¢˜ï¼Œå®ƒæŒ‡çš„æ˜¯ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç¨‹åºï¼Œæˆ‘ä»¬æ— æ³•è®¾è®¡ä¸€ä¸ªç®—æ³•æ¥åˆ¤æ–­å®ƒæ˜¯å¦ä¼šåœ¨æœ‰é™æ—¶é—´å†…åœæœºï¼ˆå³åˆ¤æ–­ç¨‹åºæ˜¯å¦ä¼šæ­»å¾ªç¯ï¼‰ã€‚

æˆ‘ä»¬é€šè¿‡åè¯æ³•å¯ä»¥è¯æ˜ï¼š

å‡è®¾å­˜åœ¨å‡½æ•° `willHalt(func F)` å¯ä»¥åˆ¤æ–­å‡½æ•° F æ˜¯å¦ä¼šåœæœºï¼Œå¦‚æœä¼šï¼Œåˆ™è¿”å› `true`ï¼Œå¦åˆ™è¿”å› `false`ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªè¿™æ ·çš„å‡½æ•° `foo()`ï¼š

```cpp
void foo() {
    if ( willHalt(foo) ) {
        while (true) {} // Endless loop.
    }
    return;
}
```

æ¥ä¸‹æ¥ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çŸ¥é“ `foo()` æ˜¯å¦ä¼šåœæœºï¼Œå°±ä¼šæ‰§è¡Œ `willHalt(foo)`ã€‚ç„¶è€Œåœ¨ `foo()` å†…éƒ¨ä¹Ÿè¿è¡Œäº†ä¸€æ¬¡ `willHalt(foo)`ï¼Œå¦‚æœå®ƒè®¤ä¸º `foo()` ä¼šåœæœºï¼Œåˆ™æ„é€ ä¸€ä¸ªæ­»å¾ªç¯ï¼›è€Œå¦‚æœå®ƒè®¤ä¸º `foo()` ä¸ä¼šåœæœºï¼Œåˆ™é€‰æ‹©è®©å®ƒç«‹åˆ»åœæœºï¼Œäºæ˜¯è¿™é‡Œå°±äº§ç”Ÿäº†çŸ›ç›¾ã€‚

ç†è§£ä¸Šé¢è¿™æ®µå†…å®¹çš„å…³é”®å°±æ˜¯ï¼Œè¿™é‡Œè™½ç„¶ä¸å­˜åœ¨äº‹å®æ„ä¹‰ä¸Šçš„â€œæ­»å¾ªç¯â€ï¼Œä½†å¯ä»¥ç†è§£ä¸ºè¿™é‡Œå­˜åœ¨ä¸€ä¸ªé€»è¾‘ä¸Šçš„é€’å½’ï¼Œè€Œè¿™ç§â€œé€»è¾‘ä¸Šçš„é€’å½’â€ï¼Œæ­£æ˜¯å¯¼è‡´åœæœºé—®é¢˜æˆä¸ºä¸€ä¸ªä¸å¯è®¡ç®—é—®é¢˜çš„åŸå› ã€‚

---

### Circuit-SAT


---

## ç›¸å…³æ¦‚å¿µ

!!! info "è¯´æ˜"
    ä»¥ä¸‹éƒ¨åˆ†çš„å†…å®¹æ˜¯ä¸ºäº†è¿›ä¸€æ­¥è¯´æ˜ä¸Šæ–‡ä¸­éƒ¨åˆ†å†…å®¹è€Œä»‹ç»çš„æ¦‚å¿µï¼Œå¹¶ä¸å…·æœ‰ç»„ç»‡ç»“æ„ã€‚

---

### å›¾çµæœº

!!! quote "Links"
    Wikipedia: https://en.wikipedia.org/wiki/Turing_machine

    Wikipedia: https://en.wikipedia.org/wiki/Nondeterministic_Turing_machine

å›¾çµæœºæœ‰ä¸€äº›å˜ä½“ï¼Œè€Œæˆ‘ä»¬åœ¨è¿™é‡Œå¼•å…¥å›¾çµæœºæ˜¯ä¸ºäº†ä»‹ç» P/NPï¼Œåªä»‹ç»**ç¡®å®šå‹å›¾çµæœº**å’Œ**éç¡®å®šå‹å›¾çµæœº**ã€‚

> å›¾çµæœºç”±ä¸€ä¸ª**æ— é™é•¿çš„çº¸å¸¦**å’Œä¸€ä¸ª**è¯»å†™å¤´**ç»„æˆã€‚çº¸å¸¦è¢«åˆ’åˆ†ä¸ºä¸€ä¸ªä¸ª**æ ¼å­**ï¼Œæ¯ä¸ªæ ¼å­ä¸Šæœ‰ä¸€ä¸ª**ç¬¦å·**ï¼Œè¯»å†™å¤´å¯ä»¥åœ¨çº¸å¸¦ä¸Šç§»åŠ¨ï¼Œè¯»å†™å¤´å¯ä»¥è¯»å–å½“å‰æ ¼å­ä¸Šçš„ç¬¦å·ï¼Œä¹Ÿå¯ä»¥æ”¹å˜å½“å‰æ ¼å­ä¸Šçš„ç¬¦å·ã€‚å›¾çµæœºçš„**çŠ¶æ€**æ˜¯ä¸€ä¸ªæœ‰é™é›†åˆï¼Œæ¯ä¸ªçŠ¶æ€éƒ½æœ‰ä¸€ä¸ª**è½¬ç§»å‡½æ•°**ï¼Œè½¬ç§»å‡½æ•°çš„è¾“å…¥æ˜¯å½“å‰çŠ¶æ€å’Œå½“å‰æ ¼å­ä¸Šçš„ç¬¦å·ï¼Œè¾“å‡ºæ˜¯ä¸‹ä¸€ä¸ªçŠ¶æ€ã€ä¸‹ä¸€ä¸ªæ ¼å­ä¸Šçš„ç¬¦å·å’Œè¯»å†™å¤´çš„ç§»åŠ¨æ–¹å‘ã€‚

æ›´æœ¬è´¨çš„æ¥è¯´ï¼Œå›¾çµæœºæ˜¯ä¸€ç§**è®¡ç®—æ¨¡å‹**ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¡¨ç¤ºä»»ä½•æœ‰é™é€»è¾‘æ•°å­¦è¿‡ç¨‹ã€‚ç¡®å®šå‹å›¾çµæœºä¸æˆ‘ä»¬å¸¸è§„ç†è§£çš„è®¡ç®—æœºé€»è¾‘ç±»ä¼¼ï¼Œå³ä¸‹ä¸€æ­¥è¦åšä»€ä¹ˆå¯ä»¥æ ¹æ®å½“å‰çŠ¶æ€ç¡®å®šã€‚è€Œéç¡®å®šå‹å›¾çµæœºåˆ™ç±»ä¼¼äºèƒ½å¤Ÿè¿›è¡Œæ— é™å¹¶è¡Œï¼Œå¹¶ä¸”æœ€ç»ˆæ€»æ˜¯é€‰æ‹©é€šå‘æ­£ç¡®ç­”æ¡ˆçš„æ–¹å‘çš„é‚£æ¡è·¯ï¼ˆæœ‰ç‚¹ç±»ä¼¼äºå®ƒèƒ½å¼€å¹³è¡Œå®‡å®™ï¼Œå¹¶ä¸”æ€»æ˜¯è®©ä½ è§‚æµ‹åˆ°æ­£ç¡®çš„é‚£ä¸€ä¸ªå¹³è¡Œå®‡å®™ï¼‰ã€‚

---

### å¤šé¡¹å¼æ—¶é—´å½’çº¦

!!! quote "Links"
    Wikipedia: https://en.wikipedia.org/wiki/Polynomial-time_reduction

æˆ‘ä»¬å¼•å…¥ P/NP ç­‰è¿™äº›æ¦‚å¿µï¼Œæ˜¯ä¸ºäº†è¡¡é‡é—®é¢˜çš„å¤æ‚ç¨‹åº¦ï¼Œè€Œå¦‚ä½•åœ¨å…·ä½“çš„â€œé—®é¢˜â€é—´ä¼ é€’ã€æ¯”è¾ƒè¿™ç§â€œå¤æ‚ç¨‹åº¦â€ï¼Œå°±æ˜¯**å¤šé¡¹å¼æ—¶é—´å½’çº¦(polynomial reduce)**çš„ç›®çš„ã€‚

```mermaid
graph LR;
A["é—®é¢˜ A"]
B["é—®é¢˜ B"]
A ===>|"å¤šé¡¹å¼æ—¶é—´è½¬åŒ–"| B
```

å¦‚æœæˆ‘ä»¬èƒ½åœ¨å¤šé¡¹å¼æ—¶é—´çš„å¤æ‚åº¦å†…ï¼Œå°†é—®é¢˜ A è½¬åŒ–ä¸ºé—®é¢˜ Bï¼Œåˆ™ç§°é—®é¢˜ A å¯ä»¥**å¤šé¡¹å¼æ—¶é—´å½’çº¦(polynomial reduce)**ä¸º Bï¼Œè®°ä¸º $A \leq_{p} B$ï¼Œè¡¨ç¤º A ä¸ä¼šæ¯” B éš¾ã€‚

è€Œé‡‡å–æ•°å­¦è¯­è¨€æ¥æè¿°ï¼Œåˆ™æ˜¯ï¼š

$$
\begin{aligned}
A \leq_{p} B 
\;\;\Leftrightarrow\;\;
& \exist f() \text{ which runs in polynomial time}, \\
& s.t.    \;\; \forall x \in A,\; f(x) \in B \\
& \text{and}\; \forall f(x) \in B,\; y \in A
\end{aligned}
$$

---