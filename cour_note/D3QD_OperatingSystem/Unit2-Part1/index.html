
<!DOCTYPE html>

<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Isshikiä¿®" name="author"/>
<link href="https://note.isshikih.top/cour_note/D3QD_OperatingSystem/Unit2-Part1/" rel="canonical"/>
<link href="../Unit1/" rel="prev"/>
<link href="../Unit2-Part2/" rel="next"/>
<link href="../../../_assets/iro/IroPatch_Brown.ico" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-9.0.12" name="generator"/>
<title>U2 Part 1: åŒæ­¥å·¥å…· | Synchronization Tools - Isshikiä¿®'s Notebook</title>
<link href="../../../assets/stylesheets/main.0d440cfe.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<style>:root{--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 96c0-17.7 14.3-32 32-32s32 14.3 32 32-14.3 32-32 32-32-14.3-32-32zm85.1 80C367 158.8 384 129.4 384 96c0-53-43-96-96-96s-96 43-96 96c0 33.4 17 62.8 42.9 80H224c-17.7 0-32 14.3-32 32s14.3 32 32 32h32v208h-48c-53 0-96-43-96-96v-6.1l7 7c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9L97 263c-9.4-9.4-24.6-9.4-33.9 0L7 319c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l7-7v6.1c0 88.4 71.6 160 160 160h160c88.4 0 160-71.6 160-160v-6.1l7 7c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-56-56c-9.4-9.4-24.6-9.4-33.9 0l-56 56c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l7-7v6.1c0 53-43 96-96 96H320V240h32c17.7 0 32-14.3 32-32s-14.3-32-32-32h-10.9z"/></svg>');--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="m368.4 18.3-55.7 55.8 125.2 125.2 55.7-55.7c21.9-21.9 21.9-57.3 0-79.2l-46-46.1c-21.9-21.9-57.3-21.9-79.2 0zM288 94.6l-9.2 2.8-144.1 43.2c-19.9 6-35.7 21.2-42.3 41L3.8 445.8c-3.8 11.3-1 23.9 7.3 32.4l153.6-153.5c-3-6.3-4.7-13.3-4.7-20.7 0-26.5 21.5-48 48-48s48 21.5 48 48-21.5 48-48 48c-7.4 0-14.4-1.7-20.7-4.7L33.7 500.9c8.6 8.3 21.1 11.2 32.4 7.3l264.3-88.6c19.7-6.6 35-22.4 41-42.3l43.2-144.1 2.8-9.2L288 94.6z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M40 48c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24V72c0-13.3-10.7-24-24-24H40zm152 16c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zm0 160c-17.7 0-32 14.3-32 32s14.3 32 32 32h288c17.7 0 32-14.3 32-32s-14.3-32-32-32H192zM16 232v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40c-13.3 0-24 10.7-24 24zm24 136c-13.3 0-24 10.7-24 24v48c0 13.3 10.7 24 24 24h48c13.3 0 24-10.7 24-24v-48c0-13.3-10.7-24-24-24H40z"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M272 384c9.6-31.9 29.5-59.1 49.2-86.2 5.2-7.1 10.4-14.2 15.4-21.4 19.8-28.5 31.4-63 31.4-100.3C368 78.8 289.2 0 192 0S16 78.8 16 176c0 37.3 11.6 71.9 31.4 100.3 5 7.2 10.2 14.3 15.4 21.4 19.8 27.1 39.7 54.4 49.2 86.2h160zm-80 128c44.2 0 80-35.8 80-80v-16H112v16c0 44.2 35.8 80 80 80zm-80-336c0 8.8-7.2 16-16 16s-16-7.2-16-16c0-61.9 50.1-112 112-112 8.8 0 16 7.2 16 16s-7.2 16-16 16c-44.2 0-80 35.8-80 80z"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M470.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L192 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 512c141.4 0 256-114.6 256-256S397.4 0 256 0 0 114.6 0 256s114.6 256 256 256zm-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM288 352c0 17.7-14.3 32-32 32s-32-14.3-32-32 14.3-32 32-32 32 14.3 32 32z"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32zm0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24zm32 224c0-17.7-14.3-32-32-32s-32 14.3-32 32 14.3 32 32 32 32-14.3 32-32z"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3c4.97 0 9 3.58 9 8s-6 10-9 10-9-5.58-9-10 4.03-8 9-8m-1.69 7.93C9.29 9.29 7.47 8.58 6.25 9.34c-1.22.76-1.38 2.71-.36 4.35 1.03 1.64 2.85 2.35 4.07 1.59 1.22-.78 1.37-2.71.35-4.35m3.38 0c-1.02 1.64-.87 3.57.35 4.35 1.22.76 3.04.05 4.07-1.59 1.02-1.64.86-3.59-.36-4.35-1.22-.76-3.04-.05-4.06 1.59M12 17.75c-2 0-2.5-.75-2.5-.75 0 .03.5 2 2.5 2s2.5-2 2.5-2-.5.75-2.5.75Z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 32c0-17.7-14.3-32-32-32s-32 14.3-32 32v11.5c0 49.9-60.3 74.9-95.6 39.6l-8.2-8.1C107.7 62.5 87.5 62.5 75 75s-12.5 32.8 0 45.3l8.2 8.2c35.2 35.2 10.2 95.5-39.7 95.5H32c-17.7 0-32 14.3-32 32s14.3 32 32 32h11.5c49.9 0 74.9 60.3 39.6 95.6l-8.1 8.2c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l8.2-8.2c35.3-35.3 95.6-10.3 95.6 39.6V480c0 17.7 14.3 32 32 32s32-14.3 32-32v-11.5c0-49.9 60.3-74.9 95.6-39.6l8.2 8.2c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-8.2-8.2c-35.3-35.3-10.3-95.6 39.6-95.6H480c17.7 0 32-14.3 32-32s-14.3-32-32-32h-11.5c-49.9 0-74.9-60.3-39.6-95.6l8.2-8.2c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-8.2 8.2C348.3 118.4 288 93.4 288 43.5V32zm-16 192c0 26.5-21.5 48-48 48s-48-21.5-48-48 21.5-48 48-48 48 21.5 48 48zm32 104c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h128c35.3 0 64 28.7 64 64v288c0 35.3-28.7 64-64 64H160c-35.3 0-64-28.7-64-64V160c0-35.3 28.7-64 64-64h128V32c0-17.7 14.3-32 32-32zM208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16h-32zM264 256c0-22.1-17.9-40-40-40s-40 17.9-40 40 17.9 40 40 40 40-17.9 40-40zm152 40c22.1 0 40-17.9 40-40s-17.9-40-40-40-40 17.9-40 40 17.9 40 40 40zM48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48zm544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224h16z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0h-32zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1z"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M579.8 267.7c56.5-56.5 56.5-148 0-204.5-50-50-128.8-56.5-186.3-15.4l-1.6 1.1c-14.4 10.3-17.7 30.3-7.4 44.6s30.3 17.7 44.6 7.4l1.6-1.1c32.1-22.9 76-19.3 103.8 8.6 31.5 31.5 31.5 82.5 0 114L422.3 334.8c-31.5 31.5-82.5 31.5-114 0-27.9-27.9-31.5-71.8-8.6-103.8l1.1-1.6c10.3-14.4 6.9-34.4-7.4-44.6s-34.4-6.9-44.6 7.4l-1.1 1.6C206.5 251.2 213 330 263 380c56.5 56.5 148 56.5 204.5 0l112.3-112.3zM60.2 244.3c-56.5 56.5-56.5 148 0 204.5 50 50 128.8 56.5 186.3 15.4l1.6-1.1c14.4-10.3 17.7-30.3 7.4-44.6s-30.3-17.7-44.6-7.4l-1.6 1.1c-32.1 22.9-76 19.3-103.8-8.6C74 372 74 321 105.5 289.5l112.2-112.3c31.5-31.5 82.5-31.5 114 0 27.9 27.9 31.5 71.8 8.6 103.9l-1.1 1.6c-10.3 14.4-6.9 34.4 7.4 44.6s34.4 6.9 44.6-7.4l1.1-1.6C433.5 260.8 427 182 377 132c-56.5-56.5-148-56.5-204.5 0L60.2 244.3z"/></svg>');}</style>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono"}</style>
<link href="../../../_css/extra.css" rel="stylesheet"/>
<link href="../../../_css/flink.css" rel="stylesheet"/>
<link href="https://jsd.cdn.zzko.cn/npm/katex@0.16.4/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-4P08GMSPJM"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-4P08GMSPJM",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-4P08GMSPJM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
<link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../../../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="brown" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#u2-part-1-åŒæ­¥å·¥å…·--synchronization-tools">
          è·³è½¬è‡³
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="é¡µçœ‰" class="md-header__inner md-grid">
<a aria-label="Isshikiä¿®'s Notebook" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Isshikiä¿®'s Notebook">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M.989 8 .064 2.68a1.342 1.342 0 0 1 1.85-1.462l13.402 5.744a1.13 1.13 0 0 1 0 2.076L1.913 14.782a1.343 1.343 0 0 1-1.85-1.463L.99 8Zm.603-5.288L2.38 7.25h4.87a.75.75 0 0 1 0 1.5H2.38l-.788 4.538L13.929 8Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Isshikiä¿®'s Notebook
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              U2 Part 1: åŒæ­¥å·¥å…· | Synchronization Tools
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="æœç´¢" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="æœç´¢" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="æŸ¥æ‰¾" class="md-search__options">
<a aria-label="åˆ†äº«" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="åˆ†äº«">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg>
</a>
<button aria-label="æ¸…ç©ºå½“å‰å†…å®¹" class="md-search__icon md-icon" tabindex="-1" title="æ¸…ç©ºå½“å‰å†…å®¹" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/IsshikiHugh/notebook" title="å‰å¾€ä»“åº“">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    IsshikiHugh/notebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="æ ‡ç­¾" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
        ğŸ’  å°é¢
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../tech_accu/">
        ğŸ“š æŠ€æœ¯ç§¯ç´¯
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../">
        ğŸ—’ è¯¾ç¨‹ç¬”è®°
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../pape_read/">
        ğŸ“ è®ºæ–‡é˜…è¯»
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../others/">
        ğŸ“¦ æ‚é¡¹ä¸“é¢˜
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../coming/">
        ğŸš§ æ–½å·¥ä¸­...
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="å¯¼èˆªæ " class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Isshikiä¿®'s Notebook" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Isshikiä¿®'s Notebook">
<svg viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M.989 8 .064 2.68a1.342 1.342 0 0 1 1.85-1.462l13.402 5.744a1.13 1.13 0 0 1 0 2.076L1.913 14.782a1.343 1.343 0 0 1-1.85-1.463L.99 8Zm.603-5.288L2.38 7.25h4.87a.75.75 0 0 1 0 1.5H2.38l-.788 4.538L13.929 8Z"></path></svg>
</a>
    Isshikiä¿®'s Notebook
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/IsshikiHugh/notebook" title="å‰å¾€ä»“åº“">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</div>
<div class="md-source__repository">
    IsshikiHugh/notebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../..">ğŸ’  å°é¢</a>
<label for="__nav_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
          ğŸ’  å°é¢
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../link/">
        ğŸ’¬ äº¤æµ
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/">ğŸ“š æŠ€æœ¯ç§¯ç´¯</a>
<label for="__nav_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          ğŸ“š æŠ€æœ¯ç§¯ç´¯
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/tool/">å¸¸ç”¨å·¥å…·</a>
<label for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          å¸¸ç”¨å·¥å…·
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech_accu/tool/Shell/">
        Shell
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/tool/Git/">Git Something</a>
<label for="__nav_2_2_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_3">
<span class="md-nav__icon md-icon"></span>
          Git Something
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech_accu/tool/Git/Workflow/">
        Git Workflow
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech_accu/tool/Git/Commands/">
        Git Commands
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://sites.google.com/a/chromium.org/dev/developers/fast-intro-to-git-internals">
        ğŸ”— A Fast Intro to Git Internals
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://mp.weixin.qq.com/s/fQFOGAv9cdvdZTpyL_9y8g">
        ğŸ”— .git ç›®å½•é‡Œåˆ°åº•åŒ…å«äº†ä»€ä¹ˆï¼Ÿ
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
          MinIO
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_4">
<span class="md-nav__icon md-icon"></span>
          MinIO
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.minio.org.cn/">
        ğŸ”— Website
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="http://docs.minio.org.cn/minio/baremetal/">
        ğŸ”— Docs
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://juejin.cn/post/7002026185391603749">
        ğŸ”— Notes of MinIO x Golang
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2_5" id="__nav_2_2_5_label" tabindex="0">
          Docker
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_5">
<span class="md-nav__icon md-icon"></span>
          Docker
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://medium.com/geekculture/docker-build-with-mac-m1-d668c802ab96">
        ğŸ”— Docker build with Mac M1
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2_6" id="__nav_2_2_6_label" tabindex="0">
          makefile
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_2_6">
<span class="md-nav__icon md-icon"></span>
          makefile
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://opensource.com/article/18/8/what-how-makefile">
        ğŸ”— What is a Makefile and how does it work?
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://seisman.github.io/how-to-write-makefile/introduction.html#">
        ğŸ”— makefile ä»‹ç»
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech_accu/tool/Colab/">
        Google Colaboratory
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
          ç¼–ç¨‹è¯­è¨€
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          ç¼–ç¨‹è¯­è¨€
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3_1" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/language/cpp/">C++</a>
<label for="__nav_2_3_1">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_3_1">
<span class="md-nav__icon md-icon"></span>
          C++
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech_accu/language/cpp/Part0/">
        [pre] å‰ç½®ä¸æ‚é¡¹
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/standard/BVH_format/">æ ‡å‡† | æ ¼å¼ | è§„èŒƒ</a>
<label for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
          æ ‡å‡† | æ ¼å¼ | è§„èŒƒ
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://www.yuque.com/isshikixiu/codes/gd5vxi">
        ğŸ‘‰ OAuth
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types">
        ğŸ”— MIME
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/ai/">äººå·¥æ™ºèƒ½</a>
<label for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
          äººå·¥æ™ºèƒ½
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tech_accu/ai/pytorch/">
        PyTorch
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../tech_accu/ai/hydra/">Hydra</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_5_3">
<span class="md-nav__icon md-icon"></span>
          Hydra
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5_4" id="__nav_2_5_4_label" tabindex="0">
          Pytorch Lighting
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_5_4">
<span class="md-nav__icon md-icon"></span>
          Pytorch Lighting
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://lightning.ai/docs/pytorch/stable/">
        ğŸ”— å®˜æ–¹æ–‡æ¡£
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://medium.com/%E6%95%B8%E5%AD%B8-%E4%BA%BA%E5%B7%A5%E6%99%BA%E6%85%A7%E8%88%87%E8%9F%92%E8%9B%87/pytorch-lightning-%E5%85%A5%E5%9D%91%E5%BF%83%E5%BE%97-81af12de9bb7">
        ğŸ”— PyTorch Lightning å…¥å‘å¿ƒå¾—
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../">ğŸ—’ è¯¾ç¨‹ç¬”è®°</a>
<label for="__nav_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          ğŸ—’ è¯¾ç¨‹ç¬”è®°
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1QD_CXiaoCheng/">
        ğŸ”® Cå°ç¨‹ çç¢çŸ¥è¯†ç‚¹æ•´ç†
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../D1CX_ProbabilityAndStatistics/">ğŸ’ æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡</a>
<label for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_3">
<span class="md-nav__icon md-icon"></span>
          ğŸ’ æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap01/">
        [1.x] æ¦‚ç‡è®ºçš„åŸºæœ¬æ¦‚å¿µ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap02/">
        [2.x] éšæœºå˜é‡åŠå…¶æ¦‚ç‡åˆ†å¸ƒ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap03/">
        [3.x] å¤šå…ƒéšæœºå˜é‡åŠå…¶åˆ†å¸ƒ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap04/">
        [4.x] éšæœºå˜é‡çš„æ•°å­—ç‰¹å¾
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap05/">
        [5.x] å¤§æ•°å®šå¾‹åŠä¸­å¿ƒæé™å®šç†
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap06/">
        [6.x] ç»Ÿè®¡é‡ä¸æŠ½æ ·åˆ†å¸ƒ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap07/">
        [7.x] å‚æ•°ä¼°è®¡
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1CX_ProbabilityAndStatistics/Chap08/">
        [8.x] å‡è®¾æ£€éªŒ
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1SJ_StanfordCS231n/">
        ğŸ”® Deep Learning for Computer Vision | CS231N
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D1SJ_Intro2CS/">
        ğŸ”® è®¡ç®—æœºç³»ç»Ÿæ¦‚è®º | Introduction to Computing Systems
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../D2QD_DigitalDesign/">ğŸ’ æ•°å­—é€»è¾‘è®¾è®¡ | Digital Design</a>
<label for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
          ğŸ’ æ•°å­—é€»è¾‘è®¾è®¡ | Digital Design
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap01/">
        Chap 1 Digital Systems and Information
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap02/">
        Chap 2 Combinational Logic Circuits
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap03/">
        Chap 3 Combinational Logic Design
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap04/">
        Chap 4 Sequential Circuits
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap05/">
        Chap 5 Digital Hardware Implementation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap06/">
        Chap 6 Registers &amp; Register Transfers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_DigitalDesign/Chap07/">
        Chap 7 Memory Basics
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_7" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../D2QD_Intro2CV/">ğŸ’ è®¡ç®—æœºè§†è§‰å¯¼è®º | I2CV</a>
<label for="__nav_3_7">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_7">
<span class="md-nav__icon md-icon"></span>
          ğŸ’ è®¡ç®—æœºè§†è§‰å¯¼è®º | I2CV
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec01/">
        Lecture 1 | Introduction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec02/">
        Lecture 2 | Image Formation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec03/">
        Lecture 3 | Image Processing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec04/">
        Lecture 4 | Model Fitting and Optimization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec05/">
        Lecture 5 | Feature Matching and Motion Estimation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec06/">
        Lecture 6 | Image Alignment and Stitching
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec07/">
        Lecture 7 | Structure From Motion
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec08/">
        Lecture 8 | Depth Estimation &amp; 3D Reconstruction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec09/">
        Lecture 9 | Deep Learning
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec10/">
        Lecture 10 | Recognition
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec11/">
        Lecture 11 | 3D Deep Learning
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec12/">
        Lecture 12 | Computational Photography 1
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2QD_Intro2CV/Lec13/">
        Lecture 13 | Computational Photography 2
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2HJ_StanfordWriting/">
        ğŸ”® ç§‘å­¦æ–‡ç« å†™ä½œ | Writing in the Sciences
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_9" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../D2CX_ComputerOrganization/">ğŸ”® è®¡ç®—æœºç»„æˆ | Computer Organization</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_9_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_9">
<span class="md-nav__icon md-icon"></span>
          ğŸ”® è®¡ç®—æœºç»„æˆ | Computer Organization
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_10" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../D2CX_AdvancedDataStructure/">ğŸ’ é«˜çº§æ•°æ®ç»“æ„ | Advanced Data Structure</a>
<label for="__nav_3_10">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_10_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_10">
<span class="md-nav__icon md-icon"></span>
          ğŸ’ é«˜çº§æ•°æ®ç»“æ„ | Advanced Data Structure
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec01/">
        Lecture 1 | AVL Trees &amp; Splay Trees
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec02/">
        Lecture 2 | Red Black Tree &amp; B+ Tree
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec03/">
        Lecture 3 | Inverted File Index
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec04/">
        Lecture 4 | Leftist Heap &amp; Skew Heap
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec05/">
        Lecture 5 | Binomial Queue
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec06/">
        Lecture 6 | Backtracing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec07/">
        Lecture 7 | Divide &amp; Conquer
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec08/">
        Lecture 8 | Dynamic Programming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec09/">
        Lecture 9 | Greedy Algorithms
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec10/">
        Lecture 10 | NP Completeness
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec11/">
        Lecture 11 | Approximation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec12/">
        Lecture 12 | Local Search
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec13/">
        Lecture 13 | Randomized Algorithms
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec14/">
        Lecture 14 | Parallel
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Lec15/">
        Lecture 15 | External Sorting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../D2CX_AdvancedDataStructure/Ex01/">
        Topic 1 | Amortized Analysis
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3_11" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">ğŸ’ æ“ä½œç³»ç»Ÿ | Operating System</a>
<label for="__nav_3_11">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_3_11_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_11">
<span class="md-nav__icon md-icon"></span>
          ğŸ’ æ“ä½œç³»ç»Ÿ | Operating System
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit0/">
        Unit 0: æ€»è§ˆ | Overview
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit1/">
        Unit 1: è¿›ç¨‹ç®¡ç† | Process Management
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_3_11_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_11_4" id="__nav_3_11_4_label" tabindex="0">
          Unit 2 åŒæ­¥ | Synchronization
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_3_11_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_11_4">
<span class="md-nav__icon md-icon"></span>
          Unit 2 åŒæ­¥ | Synchronization
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          U2 Part 1: åŒæ­¥å·¥å…· | Synchronization Tools
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        U2 Part 1: åŒæ­¥å·¥å…· | Synchronization Tools
      </a>
<nav aria-label="ç›®å½•" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ç«æ€æ¡ä»¶">
    ç«æ€æ¡ä»¶
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-critical-section-problem">
    The Critical-Section Problem
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#for-kernel-code">
    For Kernel Code
  </a>
<nav aria-label="For Kernel Code" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#petersons-algorithm">
    Petersonâ€™s Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ç®—æ³•æè¿°">
    ç®—æ³•æè¿°
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#æ€§è´¨è¯æ˜">
    æ€§è´¨è¯æ˜
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#memory-barriers">
    Memory Barriers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hardware-instructions">
    Hardware Instructions
  </a>
<nav aria-label="Hardware Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#test_and_set">
    test_and_set()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#compare_and_swap">
    compare_and_swap()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#atomic-variables">
    Atomic Variables
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mutex-locks">
    Mutex Locks
  </a>
<nav aria-label="Mutex Locks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#å¿™ç­‰å¾…">
    å¿™ç­‰å¾…
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#semaphores">
    Semaphores
  </a>
<nav aria-label="Semaphores" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ä½¿ç”¨">
    ä½¿ç”¨
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#é¿å…å¿™ç­‰å¾…">
    é¿å…å¿™ç­‰å¾…
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit2-Part2/">
        U2 Part 2: åŒæ­¥é—®é¢˜ä¾‹å­ | Synchronization Problems Examples
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit2-Part3/">
        U2 Part 3: æ­»é” | Deadlocks
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_11_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_11_5" id="__nav_3_11_5_label" tabindex="0">
          Unit 3 å†…å­˜ | Memory
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_11_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_3_11_5">
<span class="md-nav__icon md-icon"></span>
          Unit 3 å†…å­˜ | Memory
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit3-Part1/">
        U3 Part 1: å†…å­˜è®¾è®¡ | Memory Design
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit3-Part2/">
        U3 Part 2: å†…å­˜ç®¡ç† | Memory Management
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit4/">
        Unit 4: è¾“å…¥/è¾“å‡º | I/O
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit5/">
        Unit 5: å­˜å‚¨ | Storage
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Unit6/">
        Unit 6: æ–‡ä»¶ç³»ç»Ÿ | File System
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_12" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../D3QD_ComputerNetwork/">ğŸ”® è®¡ç®—æœºç½‘ç»œ | Computer Network</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_12_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_12">
<span class="md-nav__icon md-icon"></span>
          ğŸ”® è®¡ç®—æœºç½‘ç»œ | Computer Network
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_13" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_13" id="__nav_3_13_label" tabindex="0">
          ğŸ”® è®¡ç®—ç†è®º | Theorem of Computing
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_13_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_13">
<span class="md-nav__icon md-icon"></span>
          ğŸ”® è®¡ç®—ç†è®º | Theorem of Computing
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://note.tonycrane.cc/cs/tcs/toc/">
        ğŸ”— xg çš„ toc ç¬”è®°
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../pape_read/">ğŸ“ è®ºæ–‡é˜…è¯»</a>
<label for="__nav_4">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          ğŸ“ è®ºæ–‡é˜…è¯»
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
          èµ„æº
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_4_2">
<span class="md-nav__icon md-icon"></span>
          èµ„æº
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://nn.labml.ai/">
        ğŸ”— Annotated Deep Learning Paper Implementations
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/NeRF/">
        [NeRF] Representing Scenes as Neural Radiance Fields for View Synthesis
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/ACTOR/">
        [ACTOR] Action-Conditioned 3D Human Motion Synthesis with Transformer VAE
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/NSM/">
        [NSM] Neural State Machine for Character-Scene Interactions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/SAMP/">
        [SAMP] Stochastic Scene-Aware Motion Prediction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/EG3D/">
        [EG3D] Efficient Geometry-aware 3D Generative Adversarial Networks
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/SA-MHR/">
        [SA-HMR] Learning Human Mesh Recovery in 3D Scenes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pape_read/TRACE/">
        [TRACE] 5D Temporal Regression of Avatars with Dynamic Cameras in 3D Environments
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://isshikih.notion.site/Keep-It-SMPL-Automatic-Estimation-of-3D-Human-Pose-and-Shape-from-a-Single-Image-6dc0538b3e124a7cbff3993ed6e17f9e">
        [SMPLify] Keep It SMPL: Automatic Estimation of 3D Human Pose and Shape from a Single Image
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://isshikih.notion.site/Expressive-Body-Capture-3D-Hands-Face-and-Body-from-a-Single-Image-b02c3d1452e64869977c7ca8e83502b5?pvs=4">
        [SMPL-X] Expressive Body Capture: 3D Hands, Face, and Body from a Single Image
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://isshikih.notion.site/HuMoR-3D-Human-Motion-Model-for-Robust-Pose-Estimation-2f9c84ed776446ab8b878120fff1ba2a?pvs=4">
        [HuMoR] 3D Human Motion Model for Robust Pose Estimation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://isshikih.notion.site/Decoupling-Human-and-Camera-Motion-from-Videos-in-the-Wild-b960992c07fe4739a3dd939c22b9d94b?pvs=4">
        [SLAHMR] Decoupling Human and Camera Motion from Videos in the Wild
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../../others/">ğŸ“¦ æ‚é¡¹ä¸“é¢˜</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          ğŸ“¦ æ‚é¡¹ä¸“é¢˜
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../others/tools/">
        å·¥å…·æ”¶é›†
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../others/reveal-md2Slides/">
        ä½¿ç”¨ reveal-md æ¥å†™ Slides
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
          æ‚æ–‡æ”¶é›†
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_4">
<span class="md-nav__icon md-icon"></span>
          æ‚æ–‡æ”¶é›†
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="https://solarianprogrammer.com/2013/05/22/opengl-101-matrices-projection-view-model/">
        ğŸ”— OpenGL 101: Matrices-projection/view/model
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://zhuanlan.zhihu.com/p/35005794">
        ğŸ”— å…¨é¢è§£è¯» Group Normalization
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-load-obj.html">
        ğŸ”— WebGL åŠ è½½ .obj æ–‡ä»¶
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          ğŸš§ æ–½å·¥ä¸­...
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          ğŸš§ æ–½å·¥ä¸­...
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../coming/">
        å†…å®¹æ­£åœ¨ç¼–è¾‘ä¸­â€¦â€¦
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="ç›®å½•" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#ç«æ€æ¡ä»¶">
    ç«æ€æ¡ä»¶
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-critical-section-problem">
    The Critical-Section Problem
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#for-kernel-code">
    For Kernel Code
  </a>
<nav aria-label="For Kernel Code" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#petersons-algorithm">
    Petersonâ€™s Algorithm
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#ç®—æ³•æè¿°">
    ç®—æ³•æè¿°
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#æ€§è´¨è¯æ˜">
    æ€§è´¨è¯æ˜
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#memory-barriers">
    Memory Barriers
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#hardware-instructions">
    Hardware Instructions
  </a>
<nav aria-label="Hardware Instructions" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#test_and_set">
    test_and_set()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#compare_and_swap">
    compare_and_swap()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#atomic-variables">
    Atomic Variables
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#mutex-locks">
    Mutex Locks
  </a>
<nav aria-label="Mutex Locks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#å¿™ç­‰å¾…">
    å¿™ç­‰å¾…
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#semaphores">
    Semaphores
  </a>
<nav aria-label="Semaphores" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#ä½¿ç”¨">
    ä½¿ç”¨
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#é¿å…å¿™ç­‰å¾…">
    é¿å…å¿™ç­‰å¾…
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="u2-part-1-åŒæ­¥å·¥å…·--synchronization-tools">U2 Part 1: åŒæ­¥å·¥å…· | Synchronization Tools<a class="headerlink" href="#u2-part-1-åŒæ­¥å·¥å…·--synchronization-tools" title="Permanent link">Â¶</a></h1>
<div style="margin-top: -30px; font-size: 0.75em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8V2m6.78 1a.69.69 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38-2.5-2.5Z"></path></svg></span> çº¦ 8261 ä¸ªå­— <span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6zm80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3z"></path></svg></span> 216 è¡Œä»£ç  <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3L12.5 13Z"></path></svg></span> é¢„è®¡é˜…è¯»æ—¶é—´ 44 åˆ†é’Ÿ</p>
</div>
<div class="admonition info">
<p class="admonition-title">å¼•å…¥</p>
<blockquote>
<p>é¦–å…ˆæˆ‘ä»¬<strong>ç®€å•</strong>æè¿°ä»€ä¹ˆæ˜¯åŒæ­¥é—®é¢˜ï¼Œè¯»è€…å¯ä»¥æŠ±ç€å¯¹ä¸‹é¢è¿™æ®µè¯çš„ç–‘é—®å»é˜…è¯»æ¥ä¸‹æ¥çš„å†…å®¹ã€‚</p>
<p>ä¸å¿…å°è¯•ç«‹åˆ»ç†è§£è¿™æ®µè¯ï¼Œæˆ‘å¸Œæœ›è¯»è€…èƒ½å¤Ÿåœ¨çœ‹çš„è¿‡ç¨‹ä¸­ä»¥ä¸‹é¢è¿™æ®µè¯ä¸ºä¸»çº¿ï¼ŒçŒœæµ‹æ¥ä¸‹æ¥å°†è¦å±•å¼€çš„å†…å®¹ï¼Œå»å‘ç°é—®é¢˜ã€æ€è€ƒè§£å†³åŠæ³•ã€‚</p>
</blockquote>
<p>åœ¨æ”¯æŒå¹¶å‘ç”šè‡³å¹¶è¡Œçš„ç³»ç»Ÿä¸­ï¼Œè™½ç„¶è¿›ç¨‹ä¹‹é—´ç›¸å¯¹éš”ç¦»ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹äº’ä¸<strong>ç›´æ¥</strong>å¹²æ‰°ï¼Œéƒ½æ˜¯è‡ªé¡¾è‡ªè·‘ã€‚å³ï¼Œæ˜¯å¼‚æ­¥çš„ã€‚ä½†ç”±äº<strong>å„äº›åŸå› </strong>ï¼ˆä¾‹å¦‚éƒ½éœ€è¦å¯¹ä¸€å…±äº«èµ„æºçš„ä¿®æ”¹ï¼‰ï¼Œè¿›ç¨‹ä¹‹é—´çš„æ‰§è¡Œéœ€è¦äº’ç›¸åˆ¶çº¦ï¼Œéµå¾ªç‰¹å®šçš„å…ˆåé¡ºåºï¼Œå› æ­¤è¿›ç¨‹éœ€è¦é€šè¿‡<strong>æŸäº›æ‰‹æ®µ</strong>ï¼Œè®©åä½œè¿›ç¨‹èƒ½å¤Ÿç›´æ¥æˆ–é—´æ¥äº†è§£åˆ°å…¶å®ƒç›¸å…³è¿›ç¨‹çš„çŠ¶æ€ï¼Œä»¥å®ç°å¯¹å½“å‰è¿›ç¨‹æ‰§è¡Œçš„æ§åˆ¶ï¼Œæœ€ç»ˆåœ¨å®è§‚ä¸Šå®ç°ä¸€ç§â€œåŒæ­¥â€ã€‚</p>
<p>è€Œä¸Šé¢æåˆ°çš„â€œ<strong>å„ç§åŸå› </strong>â€å’Œâ€œ<strong>æŸäº›æ‰‹æ®µ</strong>â€ï¼Œå°±æ˜¯æˆ‘ä»¬ç¨åå°†è®¨è®ºçš„ä¸œè¥¿ã€‚å…¶ä¸­ï¼Œè¿™é‡Œçš„â€œ<strong>æŸäº›æ‰‹æ®µ</strong>â€ï¼Œå°±æ˜¯æŒ‡æˆ‘ä»¬çš„å„ç§åŒæ­¥å·¥å…·ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒåŒæ­¥å¹¶ä¸æ˜¯æŸç§ä¸­å¿ƒåŒ–çš„è°ƒæ§æœºåˆ¶ï¼Œè€Œæ›´åƒæ˜¯ä¸€ç§â€œåè®®â€ï¼šå½“å„ä¸ªè¿›ç¨‹å‘ç°æœ‰åˆ«çš„è¿›ç¨‹ä¸è‡ªå·±äº§ç”Ÿç«äº‰æ—¶ï¼Œåº”å½“æœ‰æŸç§æ‰‹æ®µå…è®¸å®ƒä»¬è¾¾æˆåå•†ï¼Œä»¥å†³å®šè°å…ˆè°åã€‚</p>
<p>æˆ‘ä»¬æŒ‰ç…§é—®é¢˜çš„å¤æ‚ç¨‹åº¦ï¼Œç”±æµ…å…¥æ·±åœ°è®¨è®ºè¿™äº›ä¸œè¥¿ã€‚</p>
</div>
<div class="admonition warning">
<p class="admonition-title">è¯­å¢ƒé—®é¢˜</p>
<p>ä¸€ä¸ªæ¯”è¾ƒå°´å°¬çš„é—®é¢˜æ˜¯ï¼Œä¹¦æœ¬ä¸Šä»¥åä½œè¿›ç¨‹çš„è¯­å¢ƒä¸ºå¼€ç¯‡ï¼Œä½†æ¥ä¸‹æ¥è®²çš„æœ‰äº›å†…å®¹æ˜¯ä»¥çº¿ç¨‹åŒæ­¥ä¸ºè¯­å¢ƒï¼ˆå¯¹äºè¿™ä¸ªé—®é¢˜æˆ‘å·²ç»æ”¾å¼ƒå»æ¢³ç†å’Œçº æ­£ä¹¦ä¸­çš„æªè¾äº†ï¼Œç´¯äº†ï¼‰ï¼Œå¦‚æœåœ¨ç”¨è¯ä¸Šéƒ½åŒºåˆ†çº¿ç¨‹å’Œè¿›ç¨‹ï¼Œé‚£ä¹ˆä¼šå˜å¾—å¾ˆç¹æ‚ï¼Œæ‰€ä»¥æˆ‘æ¥ä¸‹æ¥ä¸€å¾‹ç”¨è¿›ç¨‹è¡¨ç¤ºï¼Œä½†è¯»è€…å¿ƒä¸­åº”å½“å¯¹è¿™ä¸ªè¯­å¢ƒæ›´é€‚äºçº¿ç¨‹è¿˜æ˜¯è¿›ç¨‹æœ‰æ‰€æ„Ÿå—ã€‚</p>
<p>å…³äºè¿™äº›æ–¹æ³•æ›´é€‚åˆåœ¨ process è¿˜æ˜¯ thread ä¸Šè¢«åº”ç”¨ï¼Œå¯ä»¥çœ‹<a href="https://stackoverflow.com/a/4623428/22331129" target="_blank">è¿™ä¸ª</a>ã€‚</p>
</div>
<h2 id="ç«æ€æ¡ä»¶">ç«æ€æ¡ä»¶<a class="headerlink" href="#ç«æ€æ¡ä»¶" title="Permanent link">Â¶</a></h2>
<div class="admonition quote">
<p class="admonition-title">Links</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Race_condition" target="_blank">Race Condition | Wikipedia</a></li>
</ul>
</div>
<p>æˆ‘ä»¬éœ€è¦æ„è¯†åˆ°ï¼Œæˆ‘ä»¬æ— æ³•ä¸€æ­¥åˆ°ä½åœ°ã€in-place åœ°å»ä¿®æ”¹ä¸€ä¸ªå†…å­˜ä¸­çš„æ•°æ®ã€‚æ¢è¨€ä¹‹ï¼Œè¦æƒ³ä¿®æ”¹ <code>mem[x]</code>ï¼Œæˆ‘ä»¬éœ€è¦ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li><code>reg</code> &lt;- <code>mem[x]</code>ï¼›</li>
<li><code>reg</code> &lt;- update(<code>reg</code>)ï¼›</li>
<li><code>mem[x]</code> &lt;- <code>reg</code>ï¼›</li>
</ol>
<p>è€Œå¦‚æœç°åœ¨ä¸æ­¢ä¸€ä¸ªè¿›ç¨‹åœ¨ä¿®æ”¹ <code>mem[x]</code>ï¼Œä¾‹å¦‚ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ process A    â”‚ process B    â”‚ mem[x] = 1 (initial)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ t0 &lt;- mem[x] â”‚ t0 &lt;- mem[x] â”‚ mem[x] = 1
â”‚ t0 &lt;- t0 + 1 â”‚ t0 &lt;- t0 + 1 â”‚
â”‚ mem[x] &lt;- t0 â”‚ t0 &lt;- t0 + 1 â”‚ mem[x] = 2, B's t0 is out of date
â”‚              â”‚ mem[x] &lt;- t0 â”‚ mem[x] = 3, 2 is overwritten
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></td></tr></table></div>
<p>å®ƒä»¬éƒ½æƒ³è¦æ›´æ–° <code>mem[x]</code>ï¼Œåˆå¥½å·§ä¸å·§çš„å®ƒä»¬å‡ ä¹åŒæ—¶å‘ç”Ÿè¯»å–äº† <code>mem[x]</code>ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°é—®é¢˜ï¼šä¸¤ä¸ªè¿›ç¨‹åŒæ—¶è¯»å– <code>mem[x]</code>ï¼Œç„¶åå„è‡ªè®¡ç®—æ›´æ–°åçš„å€¼ï¼Œç„¶åå„è‡ªå†™å› <code>mem[x]</code>ï¼›ç†æƒ³æƒ…å†µä¸‹ï¼Œæœ€ç»ˆçš„ <code>mem[x]</code> ä¼šæ¯”åŸæ¥å¤§ 3ï¼›ä½†ç°åœ¨çš„ <code>mem[x]</code> åªæ¯”åŸæ¥å¤§ 2ï¼Œå…¶ä¸­ process A å¯¹å®ƒçš„ä¿®æ”¹åœ¨ç¬¬ 7 è¡Œè¢«è¦†ç›–äº†ã€‚</p>
<p>ç©¶å…¶æ ¹æœ¬ï¼Œç”±äºæˆ‘ä»¬å¤„åœ¨å¹¶å‘è¯­å¢ƒä¸‹ï¼Œæ‰€ä»¥ä¼šå‡ºç°è‹¥å¹²ç”¨æˆ·åŒæ—¶æŒæœ‰ä¸€ä»½æ•°æ®èµ„æºçš„æƒ…å†µï¼ˆä¸ºäº†å‘æŒ¥å¹¶å‘çš„ä¼˜åŠ¿ï¼Œæˆ‘ä»¬ä¹Ÿåº”å½“å°½å¯èƒ½çš„æ»¡è¶³è¿™ç§éœ€æ±‚ï¼‰ï¼Œé€»è¾‘ä¸Šæ•°æ®ä¿®æ”¹è¿‡ç¨‹åº”å½“æ˜¯ç¬¦å·çš„ã€ç¬é—´çš„ã€ç«‹å³ç”Ÿæ•ˆçš„ï¼›ä½†å®é™…ä¸Šæˆ‘ä»¬å¯¹æ•°æ®çš„æ“ä½œæ˜¯æ•°å€¼çš„ã€éœ€è¦ä¸€æ®µæ—¶é—´æ¥å®Œæˆçš„ã€‚åœ¨è¿™ç§ï¼ˆåè€…ï¼‰è¯­å¢ƒä¸‹ï¼Œ<u>å¦‚æœè¯»å…¥æ•°å€¼å®Œæˆåˆ°å†™å…¥æ•°å€¼å®Œæˆçš„è¿‡ç¨‹ä¸­ï¼Œ<code>mem[x]</code> å‘ç”Ÿå˜åŒ–</u>ï¼Œé‚£ä¹ˆè¯¥æ“ä½œå®é™…ä¸Šæ˜¯ä½¿ç”¨è¿‡æ—¶æ•°æ®è¿›è¡Œè®¡ç®—ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ process A    â”‚ process B    â”‚ mem[x] = 1 (initial)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ t0 &lt;- mem[x] â”‚ t0 &lt;- mem[x] â”‚ mem[x] = 1
â”‚ t0 &lt;- t0 + 1 â”‚ t0 &lt;- t0 + 1 â”‚
<span class="hll">â”‚ mem[x] &lt;- t0 â”‚ t0 &lt;- t0 + 1 â”‚ mem[x] = 2, B's t0 is out of date
</span>â”‚              â”‚ mem[x] &lt;- t0 â”‚ mem[x] = 3, 2 is overwritten
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></td></tr></table></div>
<p>å¯ä»¥å‘ç°ï¼Œç¬¬å…­è¡Œçš„ <code>t0</code> ä»ç„¶åœ¨ç”¨è¢« process A æ›´æ–°ä¹‹å‰çš„ <code>mem[x]</code> åšè®¡ç®—ï¼Œå› è€Œå¯ä»¥è®¤ä¸ºæ­¤æ—¶ process B ä¸­ <code>t0</code> å‚ä¸è¿ç®—çš„ã€æš—å«çš„ <code>mem[x]</code> çš„æ•°æ®å·²ç»<strong>è¿‡æ—¶</strong>ã€‚</p>
<div class="admonition definition">
<p class="admonition-title">race condition</p>
<p>ç±»ä¼¼è¿™ç§çš„ï¼Œç”±ä¸¤ä¸ªä¿¡å·äº§ç”Ÿç«äº‰ï¼Œå…¶ç«äº‰æƒ…å†µå½±å“æœ€ç»ˆç»“æœçš„æƒ…å†µï¼Œè¢«ç§°ä¸º<strong>ç«æ€æ¡ä»¶(race condition)</strong>ã€‚åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œè°åæ‰§è¡Œï¼Œæœ€ç»ˆç»“æœå°±æ˜¯è°çš„è¾“å‡ºï¼Œè€Œå¦ä¸€ä¸ªç”¨æˆ·çš„è¾“å‡ºåˆ™ä¼šè¢«è¦†ç›–ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯¹ç«æ€æ¡ä»¶çš„çœ‹æ³•å¹¶ä¸åº”è¯¥æ˜¯â€œå¦‚ä½•æ§åˆ¶ç«äº‰ç»“æœâ€ï¼Œå› ä¸ºæ— è®ºç«äº‰ç»“æœå¦‚ä½•ï¼ˆç”šè‡³è°èµ¢äº†ç»“æœå¯èƒ½éƒ½ä¸€æ ·ï¼‰ï¼Œåªè¦è¿™ç§â€œç«äº‰â€å‡ºç°ï¼Œé‚£ä¹ˆæœ€ç»ˆç»“æœå°±æœ‰å¯èƒ½ä¸ç¬¦åˆé¢„æœŸçš„ã€‚å°±æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œæ— è®ºæœ€ç»ˆ <code>mem[x]</code> æ˜¯ 3 è¿˜æ˜¯ 2 éƒ½ä¸å¯¹ï¼Œç†æƒ³æƒ…å†µä¸‹åº”è¯¥æ˜¯ 4â€”â€”æ— è®ºæ˜¯å…ˆè¿›è¡Œ <code>+1</code> è¿˜æ˜¯å…ˆè¿›è¡Œ <code>+2</code>ã€‚</p>
<p>æˆ‘ä»¬çœŸæ­£éœ€è¦å…³æ³¨çš„é‡ç‚¹åº”è¯¥æ˜¯å¦‚ä½•<strong>é¿å…è¿™ç§ç«äº‰</strong>çš„å‡ºç°ã€‚</p>
</div>
<div class="admonition warning">
<p class="admonition-title">æ³¨æ„</p>
<p>è™½ç„¶ä¸Šé¢çš„ä¾‹å­ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿçš„ä¸¤ä¸ªç¨‹åºæ˜¯æŒ‰ç…§ç›¸åŒé€Ÿåº¦ï¼Œä¸€è¡Œä¸€ä¸ªæŒ‡ä»¤æ‰§è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å¹¶è¡Œè¯­å¢ƒä¸‹å¯¹æ‰€æœ‰è¿›ç¨‹æ‰§è¡Œçš„é€Ÿåº¦ä¸åº”å½“æœ‰æ‰€å‡è®¾ï¼Œå³è¿›ç¨‹ A ä¸çŸ¥é“è¿›ç¨‹ B çš„é€Ÿåº¦ã€‚</p>
<p>ä¸ä»…å¦‚æ­¤ï¼Œæˆ‘ä»¬ä¹Ÿå¹¶ä¸ä¸€å®šè¦åœ¨å¹¶è¡Œè¯­å¢ƒä¸‹è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œåœ¨å¤šé“è¯­å¢ƒä¸‹è¿™ä¸ªé—®é¢˜éƒ½ä¼šå‡ºç°ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ process A    â”‚     â”‚ process B    â”‚ mem[x] = 1 (initial)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              â”‚     â”‚ t0 &lt;- mem[x] â”‚ mem[x] = 1
â”‚ t0 &lt;- mem[x] â”‚â—„â”€â”€â”€â”€â”¤ &lt;ctx switch&gt; â”‚ mem[x] = 1
â”‚ t0 &lt;- t0 + 1 â”‚     â”‚              â”‚
â”‚ mem[x] &lt;- t0 â”‚     â”‚              â”‚ mem[x] = 2, B's t0 is out of date
â”‚ &lt;ctx switch&gt; â”œâ”€â”€â”€â”€â–ºâ”‚ t0 &lt;- t0 + 1 â”‚
â”‚              â”‚     â”‚ t0 &lt;- t0 + 1 â”‚ 
â”‚              â”‚     â”‚ mem[x] &lt;- t0 â”‚ mem[x] = 3, 2 is overwritten
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></td></tr></table></div>
<p>é—®é¢˜ä¾æ—§ã€‚</p>
</div>
<p>æ ¹æ®ä¸Šé¢è¿™ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœéœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼š</p>
<ol>
<li>è¿›è¡Œç¬¦å·çš„è¿ç®—è€Œéæ•°å€¼çš„è¿ç®—ï¼Œè¿™æ ·è¾“å…¥çš„å˜åŒ–èƒ½åœ¨ä»»æ„æ—¶åˆ»åæ˜ åœ¨è¾“å‡ºä¸Šï¼Œè¿™æ ·æ—¶æ—¶åˆ»åˆ»éƒ½æ˜¯â€œæœ€æ–°â€ï¼Œè€Œä¸ä¼šå‡ºç°â€œè¿‡æ—¶â€ï¼›</li>
<li>ä¿è¯è¯»å…¥æ•°å€¼å®Œæˆåˆ°å†™å…¥æ•°å€¼å®Œæˆçš„è¿‡ç¨‹ä¸­ï¼Œ<code>mem[x]</code> ä¿æŒä¸å˜ï¼Œå³ä¸¤ä¸ªå¯èƒ½ç«äº‰çš„æ“ä½œï¼Œåœ¨æ—¶é—´ä¸Šä¸åº”è¯¥æœ‰äº¤é›†ï¼›</li>
</ol>
<p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬åº”å½“é€‰æ‹©ç¬¬äºŒç§ã€‚</p>
<h2 id="the-critical-section-problem">The Critical-Section Problem<a class="headerlink" href="#the-critical-section-problem" title="Permanent link">Â¶</a></h2>
<p>ä¸ºäº†æ›´å¥½åœ°å±•å¼€ï¼Œæˆ‘ä»¬å¯¹ä¸Šé¢çš„è¿™ç§æƒ…å†µè¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ç»™å‡ºè§£å†³ race condition é—®é¢˜çš„æ–¹æ³•éœ€è¦æ»¡è¶³çš„èŒƒå¼ï¼š</p>
<p>æˆ‘ä»¬åº”å½“ä¿è¯åœ¨ä¸€ä¸ªè¿›ç¨‹åœ¨ä¿®æ”¹ <code>mem[x]</code> çš„æ—¶å€™ï¼Œå…¶å®ƒè¿›ç¨‹ä¸åº”è¯¥è¯»å– <code>mem[x]</code>ï¼ˆè‡³å°‘ä¸åº”ä»¥ä¿®æ”¹ <code>mem[x]</code> ä¸ºç›®çš„æ¥è¯»å–ï¼‰ï¼Œç›´åˆ°è¿™ä¸ªè¿›ç¨‹å®Œæˆå¯¹ <code>mem[x]</code> çš„ä¿®æ”¹ã€‚æ¢å¥è¯æ¥è¯´ï¼Œ<code>mem[x]</code> è¿™ä¸ªå…±äº«èµ„æºåº”å½“åªèƒ½è¢«ä¸€ä¸ªç”¨æˆ·æŒæœ‰ï¼Œæˆ‘ä»¬ç§°è¿™ç§åªèƒ½è¢«è‡³å¤šä¸€ä¸ªç”¨æˆ·å æœ‰çš„èµ„æºä¸ºä¸´ç•Œèµ„æºã€‚è€Œç¨‹åºä¸­è®¿é—®ä¸´ç•Œèµ„æºçš„ä»£ç æ®µï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º<strong>ä¸´ç•ŒåŒºæ®µ(critical section, CS)<sup><a href="https://en.wikipedia.org/wiki/Critical_section" target="_blank">Wiki</a></sup></strong>ã€‚</p>
<p>é‚£ä¹ˆï¼Œå¯¹äºä¹‹å‰æåˆ°è¿‡çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ‹¿å‡ºæ¥å¯¹æ¯”æ¨¡æ‹Ÿçš„éƒ¨åˆ†å°±æ˜¯ critical sectionã€‚</p>
<p>è€Œ CS é—®é¢˜ï¼ŒæŒ‡çš„å°±æ˜¯<u>å¦‚ä½•ä¿è¯æœ€å¤šåªæœ‰ä¸€ä¸ªç”¨æˆ·åœ¨æ‰§è¡Œä¸´ç•ŒåŒºæ®µçš„ä»£ç </u><sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>ã€‚</p>
<hr/>
<p>å›´ç»•ä¸´ç•ŒåŒºæ®µï¼Œæˆ‘ä»¬å®šä¹‰èƒ½å¤Ÿè§£å†³ CS é—®é¢˜çš„ä»£ç åº”å½“èƒ½å¤Ÿåšå¦‚ä¸‹åˆ’åˆ†ï¼š</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Entry Section      â”‚ &lt;-- ask for &amp; wait for permission to enter CS
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Critical Section   â”‚ &lt;-- codes manipulating critical resources
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Exit Section       â”‚ &lt;-- release the critical resources
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Remainder Section  â”‚ &lt;-- other codes
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>
<p>è¿›ç¨‹éœ€è¦åœ¨ entry section åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿè¿›å…¥ critical sectionï¼Œå³ç´¢å–ä¸´ç•Œèµ„æºï¼Œå¦‚æœä¸è¡Œåˆ™ç­‰å¾…ï¼›è€Œåœ¨è¿›å…¥ critical section åï¼Œè¿›ç¨‹éœ€è¦åœ¨ exit section é‡Šæ”¾ä¸´ç•Œèµ„æºï¼›ç„¶åè„±ç¦» CS é—®é¢˜çš„è¯­å¢ƒï¼Œè¿›å…¥ remainder section ç»§ç»­æ‰§è¡Œã€‚</p>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬è¦æ±‚è§£å†³æ–¹æ¡ˆéœ€è¦æ»¡è¶³å¦‚ä¸‹æ€§è´¨ï¼š</p>
<p><a id="r4s2csp"></a></p>
<div class="admonition definition">
<p class="admonition-title">requirements for solution to CS problem</p>
<ol>
<li>ä¸´ç•Œäº’æ–¥(mutual exclusion)ï¼šæ“ä½œåŒä¸€ä¸´ç•Œèµ„æºçš„ä¸´ç•ŒåŒºæ®µåº”å½“äº’ç›¸æ’æ–¥ï¼›<ul>
<li>å¦‚æœè¿›ç¨‹ <span class="arithmatex">\(P_i\)</span> æ­£åœ¨æ‰§è¡Œå…¶ critical sectionï¼Œé‚£ä¹ˆä¸åº”å½“æœ‰å…¶ä»–è¿›ç¨‹å¤„äºï¼ˆæ“ä½œåŒä¸€ä¸´ç•Œèµ„æºçš„ï¼‰critical sectionï¼›</li>
</ul>
</li>
<li>é€‰æ‹©æ—¶é—´æœ‰é™(progress)ï¼šé€‰æ‹©ä¸‹ä¸€ä¸ªè¿›å…¥ critical section çš„æ“ä½œåº”å½“åªæœ‰å¤„äº entry/critical/exit section çš„è¿›ç¨‹å‚ä¸ï¼Œä¸”è¯¥é€‰æ‹©åº”å½“åœ¨<strong>æœ‰é™æ—¶é—´å†…è¢«æ‰§è¡Œ</strong>ï¼›</li>
<li>ç­‰å¾…æ—¶é—´æœ‰é™(bounded waiting)ï¼šè¿›ç¨‹ç­‰å¾…è¢«å…è®¸è¿›å…¥ critical section çš„æ—¶é—´åº”å½“æ˜¯æœ‰é™çš„ï¼›</li>
</ol>
</div>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä»¥è®¨è®º CS é—®é¢˜æ˜¯å¦‚ä½•è§£å†³çš„ä¸ºä¸»çº¿ï¼Œæ¢ç´¢å¦‚ä½•è§£å†³ race conditionã€‚</p>
<div class="admonition tip">
<p class="admonition-title">å¤´è„‘é£æš´</p>
<p>æ•´ä¸ªè¿‡ç¨‹æœ‰ç‚¹åƒ<a href="./Unit1.md/#è¿›ç¨‹è°ƒåº¦" target="_bank">è°ƒåº¦</a>ï¼Œç­‰å¾…ä¸´ç•Œèµ„æºçš„è¿‡ç¨‹å°±å¥½åƒ ready æ€ç­‰å¾…è°ƒåº¦è¿‡ç¨‹ä¸­çš„ CPU èµ„æºï¼ˆCPU ä¹Ÿå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§ä¸´ç•Œèµ„æºï¼Œåªä¸è¿‡å®ƒä¸æ˜¯ç”±è¿›ç¨‹ä¸»åŠ¨å¤„ç†å’Œç´¢å–ï¼‰ã€‚</p>
<p>æ—¢ç„¶å¦‚æ­¤æˆ‘ä»¬å¯ä»¥è¿ç§»â€œçŠ¶æ€â€è¿™ä¸ªæ¦‚å¿µã€‚æˆ‘ä»¬åªå…³å¿ƒç›´æ¥ä¸ CS é—®é¢˜æœ‰å…³çš„çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œå®šä¹‰ï¼šå°±ç»ªã€ä¸´ç•Œã€æ— å…³ä¸‰ä¸ªçŠ¶æ€ã€‚</p>
<ol>
<li>å°±ç»ªæ€ï¼šè¿›ç¨‹éšæ—¶å‡†å¤‡å¥½è¿›å…¥ critical sectionï¼Œ<u><strong>æƒ³è¦</strong>æŒæœ‰ä¸´ç•Œèµ„æº</u>ï¼›</li>
<li>ä¸´ç•Œæ€ï¼šè¿›ç¨‹æ­£åœ¨æ‰§è¡Œ critical sectionï¼Œ<u><strong>æŒæœ‰</strong>ä¸´ç•Œèµ„æº</u>ï¼Œæˆ–è¿›ç¨‹æ‰§è¡Œå®Œ critical sectionï¼Œæ‰§è¡Œ exit section <u>æ­£åœ¨é‡Šæ”¾<strong>æŒæœ‰</strong>çš„ä¸´ç•Œèµ„æºä¸­</u>ï¼›</li>
<li>æ— å…³æ€ï¼šä¸å¤„äºå°±ç»ªæ€ä¹Ÿä¸å¤„äºä¸´ç•Œæ€ï¼Œä¸æƒ³è¦æŒæœ‰ä¸´ç•Œèµ„æºï¼Œæˆ–æ˜¯ä½¿ç”¨å®Œå·²ç»é‡Šæ”¾ï¼›</li>
</ol>
<p>æ ¹æ®æˆ‘ä»¬å…ˆå‰ç»™å‡ºçš„ï¼Œè§£æ³•<a href="#r4s2csp" target="_blank">éœ€è¦æ»¡è¶³çš„æ€§è´¨</a>ä¸­çš„ mutual exclusionï¼Œä¸èƒ½åŒæ—¶æœ‰å¤šä¸ªè¿›ç¨‹å¤„äºä¸´ç•Œæ€ï¼Œä½†æ˜¯å¯ä»¥æœ‰è‹¥å¹²è¿›ç¨‹å¤„äºå°±ç»ªæ€ï¼Œè€Œæ— å…³æ€åˆ™è¡¨ç¤ºä¸ä¼šäº§ç”Ÿç«äº‰ï¼Œå’Œè°ƒåº¦è¿‡ç¨‹ååˆ†ç›¸ä¼¼ã€‚</p>
<p>è¿™äº›å®šä¹‰å°†ä¼šåœ¨æˆ‘ä»¬ä¹‹åçš„æ¢ç´¢ä¸­èµ·ä½œç”¨ã€‚</p>
</div>
<h2 id="for-kernel-code">For Kernel Code<a class="headerlink" href="#for-kernel-code" title="Permanent link">Â¶</a></h2>
<p>ç”±äº kernel code ä¸‹çš„ CS é—®é¢˜è§£å†³è¾ƒä¸ºæ¸…æ™°ç›´æ¥ï¼Œæ‰€ä»¥å…ˆè¡Œä»‹ç»ã€‚</p>
<div class="admonition section">
<p class="admonition-title">For Kernel Code</p>
<p>åœ¨ kernel code ä¸­ä¹Ÿæ™®éå­˜åœ¨ç€ race condition çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼š</p>
<p><figure markdown="">
<center> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/22.png"><img alt="Race condition when assigning a pid." src="../img/22.png"/></a> </center>
Race condition when assigning a pid.
</figure></p>
<p>ä¸Šä¾‹ä¸­ <span class="arithmatex">\(P_0\)</span> å’Œ <span class="arithmatex">\(P_1\)</span> åŒæ—¶è®¿é—®äº† <code>next_available_pid</code> è¿™ä¸ªä¸´ç•Œèµ„æºï¼Œäº§ç”Ÿç«äº‰ï¼Œå¯¼è‡´æœ€åæœ‰ä¸¤ä¸ªè¿›ç¨‹ä½¿ç”¨äº†åŒä¸€ä¸ª <code>pid</code>ã€‚</p>
<p>æ¬²è§£å†³ kernel code ä¸­çš„ CS é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿è¡Œåœ¨ kernel modeï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯åœ¨ kernel code ä¸­è®¿é—®ä¸´ç•Œèµ„æºçš„è¡Œä¸ºï¼Œä»è€Œè§£å†³ CS é—®é¢˜ã€‚</p>
<p>å¯¹äºå•å¤„ç†å™¨æ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ kernel code ä¸­ç¦æ­¢ä¸­æ–­ï¼Œå°±å¯ä»¥ä¿è¯åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿è¡Œåœ¨ kernel modeï¼›è€Œå¯¹äºå¤šå¤„ç†å™¨æ¥è¯´ï¼Œè¿™ç§æ–¹æ³•å°±ä¸é‚£ä¹ˆåˆé€‚äº†â€”â€”æˆ‘ä»¬éœ€è¦åŒæ—¶å‘Šè¯‰å¤šä¸ªå¤„ç†å™¨ä¸­æ–­è¢«ç¦æ­¢ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­çš„æ—¶å»¶ä»ç„¶ä¼šäº§ç”Ÿé—®é¢˜ï¼›ä¸ä»…å¦‚æ­¤ï¼Œè¿™ä¸ªæ–¹æ³•ä¹Ÿä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚åœ¨å¤šå¤„ç†å™¨è¯­å¢ƒä¸‹ï¼Œæˆ‘ä»¬éœ€è¦å®ç°<strong>æŠ¢å å¼å†…æ ¸(preemptive kernels)</strong>å’Œ<strong>éæŠ¢å å¼å†…æ ¸(non-preemptive kernels)</strong>ï¼Œå…³é”®æ˜¯åè€…å®ç°äº†ä¸€æ®µæ—¶é—´å†…åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿è¡Œåœ¨ kernel mode<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>ã€‚</p>
</div>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¢ç´¢æ›´ä¸ºé€šç”¨çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<div class="admonition info">
<p class="admonition-title">è¯´æ˜</p>
<p>ä¸ºäº†ç®€åŒ–è¯´æ˜ä»£ç ï¼Œæˆ‘ä»¬ç”¨å…¨å¤§å†™æ¥è¡¨ç¤ºä¸€ä¸ªå…±äº«èµ„æºï¼Œä¾‹å¦‚ <code>READY</code>ï¼Œå®ƒèƒ½å¤Ÿè¢«è‹¥å¹²è¿›ç¨‹è®¿é—®ã€‚å®é™…ä¸Šè¿™ä¸ªåŠŸèƒ½åº”å½“ç”±æ“ä½œç³»ç»Ÿæä¾›ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹ã€‚</p>
</div>
<h3 id="petersons-algorithm">Petersonâ€™s Algorithm<a class="headerlink" href="#petersons-algorithm" title="Permanent link">Â¶</a></h3>
<div class="admonition quote">
<p class="admonition-title">Links</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm">Peterson's algorithm | Wikipedia</a></li>
</ul>
</div>
<p>Peterson's algorithm æ˜¯å¯¹<strong>åªæœ‰ä¸¤ä¸ªè¿›ç¨‹å‚ä¸</strong>çš„åŒæ­¥é—®é¢˜çš„ä¸€ä¸ªè§£æ³•ï¼Œå…·æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œä½†å…¶è®¾è®¡ç›¸å¯¹ç®€å•ï¼Œæ‰€ä»¥å…ˆè¡Œç»™å‡ºã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å‡è®¾ <span class="arithmatex">\(P_0\)</span> å’Œ <span class="arithmatex">\(P_1\)</span> æ˜¯å‚ä¸åŒæ­¥é—®é¢˜è®¨è®ºçš„ä¸¤ä¸ªè¿›ç¨‹ã€‚</p>
<blockquote>
<p>åŸºäº Peterson's algorithm å¯¹å¤šè¿›ç¨‹æƒ…å†µçš„æ‰©å±•è¢«ç§°ä¸º <a href="https://en.wikipedia.org/wiki/Peterson%27s_algorithm#Filter_algorithm:_Peterson's_algorithm_for_more_than_two_processes" target="_blank">filter algorithm</a>ï¼Œä½† filter algorithm ä¸æ»¡è¶³ bounded waiting time çš„æ¡ä»¶ï¼Œè¯»è€…æœ‰å…´è¶£å¯ä»¥è‡ªè¡Œäº†è§£ã€‚</p>
</blockquote>
<h3 id="ç®—æ³•æè¿°">ç®—æ³•æè¿°<a class="headerlink" href="#ç®—æ³•æè¿°" title="Permanent link">Â¶</a></h3>
<p>ä¸ºäº†ä¿è¯å¤„äºä¸´ç•Œæ€çš„è¿›ç¨‹è‡³å¤šåªæœ‰ä¸€ä¸ªï¼Œæˆ‘ä»¬åº”å½“åœ¨è¿›ç¨‹å¤„äºå°±ç»ªæ€æ—¶ï¼Œç¡®è®¤æ²¡æœ‰å…¶ä»–è¿›ç¨‹å¤„äºä¸´ç•Œæ€åå†è¿›å…¥ã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ä»¶äº‹å°±æ˜¯ï¼Œå½“æˆ‘ä»¬å¤„åœ¨ <span class="arithmatex">\(P_0\)</span> æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•çŸ¥é“ <span class="arithmatex">\(P_1\)</span> æ˜¯å¦æ­£å¤„äºä¸´ç•Œæ€å‘¢ï¼ŸPetersonâ€™s Algorithm é€šè¿‡å¦‚ä¸‹æ–¹å¼å®ç°äº†è¿™ä»¶äº‹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// `i` is 0 or 1, indicating current pid, while `j` is another pid.</span>
<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                    </span><span class="c1">// â”</span>
<span class="w">    </span><span class="n">TURN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w">                           </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">    </span><span class="c1">// â”œ entry section</span>
<span class="w">        </span><span class="c1">// i.e. wait until:             // â”‚</span>
<span class="w">        </span><span class="c1">//  (1) j exits,                // â”‚</span>
<span class="w">        </span><span class="c1">//  (2) j is slower, so it      // â”‚</span>
<span class="w">        </span><span class="c1">//      should run now.         // â”˜</span>

<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">    </span><span class="c1">// - critical section</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                   </span><span class="c1">// - exit section</span>

<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                  </span><span class="c1">// - remainder section</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p>é¦–å…ˆè¯´æ˜ï¼Œentry section æ²¡æœ‰ä¸´ç•Œèµ„æºï¼Œè¿™é‡Œçš„ <code>TURN</code> æ˜¯æˆ‘ä»¬æ•…æ„æ”¾åœ¨è¿™é‡Œçš„ã€‚</p>
</blockquote>
<p><code>READY</code> æ˜¯ä¸€ä¸ªå…±äº«çš„æ•°ç»„ï¼Œæ¯ä¸ªè¿›ç¨‹åªä¿®æ”¹ä¸è‡ªå·±ä¸€ä¸€å¯¹åº”çš„ elementï¼Œæ‰€ä»¥æœ¬è´¨ä¸Š <code>READY</code> ä¸ä¼šå‡ºç° race conditionï¼Œå› è€Œä¹Ÿä¸æ˜¯ä¸´ç•Œèµ„æºã€‚è€Œ <code>TURN</code>ï¼Œæˆ‘ä»¬åœ¨ç¬¬ 6 è¡Œåªå¯¹ <code>TURN</code> è¿›è¡Œç›´æ¥å†™çš„æ“ä½œï¼Œä½†æ˜¯ P1 å’Œ P2 è°åè·‘å®Œåˆ°è¿™ä¸€è¡Œä¼šå†³å®š <code>TURN</code> æœ€åçš„å€¼ï¼Œæ‰€ä»¥å®é™…ä¸Šè¿™é‡Œæœ‰ race conditionã€‚</p>
<p>ä½†è¿™å°±æ˜¯ Petersonâ€™s Algorithm å·§å¦™çš„åœ°æ–¹ï¼ŒPeterson's åˆ©ç”¨ race condition è¿™ä¸ªâ€œåè¦†ç›–å‰â€çš„æ€§è´¨ï¼Œå®ç°äº†æ ‡è®°äº†è¿™ä¸¤ä¸ªè¿›ç¨‹çš„å…ˆæ¥ååˆ°çš„æ•ˆæœã€‚æˆ‘ä»¬éƒ½å‘è¿™ä¸ª <code>TURN</code> å†™ä¸€ä¸ªç‹¬ç‰¹çš„å€¼ï¼ˆæ¯”å¦‚è‡ªå·±çš„ idï¼Œæˆ–è€…å¯¹æ–¹çš„ idï¼‰ï¼Œç­‰å¤§å®¶éƒ½å†™å¥½åæˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªå€¼æœ€ç»ˆæ˜¯è°å†™çš„ï¼Œäºæ˜¯å°±çŸ¥é“è°ååˆ°ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸ªåŸç†ï¼ŒPeterson's è¿™é‡Œåšäº†ä¸€ä¸ªâ€œéå¸¸æœ‰ä¸­å›½äººæ°”è´¨â€çš„äº‹æƒ…ï¼š<span class="arithmatex">\(P_0\)</span> å’Œ <span class="arithmatex">\(P_1\)</span> ä¸Šå…¬äº¤è½¦ååŒæ—¶çœ‹ä¸Šäº†ä¸€ä¸ªåº§ä½ï¼Œ<span class="arithmatex">\(P_0\)</span> è¯´ï¼šâ€œä½ åå§ã€‚â€ï¼Œ <span class="arithmatex">\(P_1\)</span> è‡ªç„¶ä¹Ÿè¦å®¢æ°”ä¸€ä¸‹ï¼Œè¯´ï¼šâ€œè¿˜æ˜¯ä½ åå§ï¼â€ã€‚ç°åœ¨ä¸¤è¾¹éƒ½å®¢æ°”è¿‡äº†ï¼Œ<span class="arithmatex">\(P_0\)</span> å°±å¯ä»¥å¿ƒå®‰ç†å¾—åœ°åä¸‹äº†ã€‚å¯¹ä¸Šè¿°è¿‡ç¨‹ï¼Œæˆ‘ä»¬ç»™å‡º <span class="arithmatex">\(P_0\)</span> è·å¾—æ¤…å­çš„å‡†ç¡®æ¡ä»¶æœ‰ï¼š</p>
<ol>
<li><span class="arithmatex">\(P_0\)</span> æƒ³åä¸‹ï¼Œ<span class="arithmatex">\(P_1\)</span> ä¹Ÿæƒ³åä¸‹ï¼ˆå¦åˆ™å°±æ²¡æœ‰å†²çªï¼Œå¯ä»¥ç›´æ¥åä¸‹äº†ï¼‰ï¼›</li>
<li><span class="arithmatex">\(P_0\)</span> å‘ç° <span class="arithmatex">\(P_1\)</span> åœ¨å®¢æ°”ï¼Œä½† <span class="arithmatex">\(P_0\)</span> <strong>å·²ç»</strong>å®¢æ°”è¿‡äº†ï¼›</li>
</ol>
<p>å¯¹åº”åˆ°ä¸Šé¢ç»™å‡ºçš„ä»£ç é‡Œï¼Œè¿™ä¸ªæ¡ä»¶å¯ä»¥ç¿»è¯‘ä¸ºï¼š</p>
<ol>
<li><code class="highlight"><span class="n">READY</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></code> = <code class="highlight"><span class="n">READY</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></code> = <code class="highlight"><span class="nb">true</span></code>ï¼›</li>
<li><code class="highlight"><span class="n">TURN</span></code> â‰  <code>j</code>ï¼Œä½†æ­¤å‰ <span class="arithmatex">\(P_i\)</span> å·²ç»æ‰§è¡Œè¿‡ <code>TURN &lt;- j</code>ï¼›</li>
</ol>
<div class="admonition advice">
<p class="admonition-title">è¯·è¯»è€…ä»”ç»†æ€è€ƒä¸Šé¢çš„è¿‡ç¨‹ï¼Œå¹¶é€‚å½“è¿›è¡Œå…¨é¢çš„æ¨¡æ‹Ÿä»¥ç†è§£ Peterson's æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
</div>
<h3 id="æ€§è´¨è¯æ˜">æ€§è´¨è¯æ˜<a class="headerlink" href="#æ€§è´¨è¯æ˜" title="Permanent link">Â¶</a></h3>
<p>ç°åœ¨æˆ‘ä»¬éœ€è¦è¯æ˜è¿™ä¸ªç®—æ³•æ»¡è¶³<a href="#r4s2csp" target="_blank">æ€§è´¨</a>ã€‚</p>
<blockquote>
<p>æˆ‘çš„è¯æ˜æ¯”è¾ƒè¯¦ç»†å’Œå•°å—¦ï¼Œä½†æˆ‘è®¤ä¸ºå®Œæ•´åœ°æ¨¡æ‹Ÿæ›´åŠ æœ‰åˆ©äºç›´è§‰ç†è§£ï¼Œå¦‚æœä½ æƒ³è¦æ›´ç®€æ´çš„è¯æ˜ï¼Œå¯ä»¥å‚è€ƒ <a href="https://xuan-insr.github.io/%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86/os/III_process_sync/6_sync_tools/#%E6%80%A7%E8%B4%A8%E8%AF%81%E6%98%8E" target="_blank">xyx çš„ç¬”è®°</a>ã€‚</p>
</blockquote>
<details class="proof">
<summary>mutual exclusion</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// `i` is 0 or 1, indicating current pid, while `j` is another pid.</span>
<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                    </span><span class="c1">// â”</span>
<span class="w">    </span><span class="n">TURN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w">                           </span><span class="c1">// â”‚</span>
<span class="hll"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">    </span><span class="c1">// â”œ entry section</span>
</span><span class="w">        </span><span class="c1">// i.e. wait until:             // â”‚</span>
<span class="w">        </span><span class="c1">//  (1) j exits,                // â”‚</span>
<span class="w">        </span><span class="c1">//  (2) j is slower, so it      // â”‚</span>
<span class="w">        </span><span class="c1">//      should run now.         // â”˜</span>

<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">    </span><span class="c1">// - critical section</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                   </span><span class="c1">// - exit section</span>

<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                  </span><span class="c1">// - remainder section</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition property">
<p class="admonition-title">lemma</p>
<p>å¦‚æœæ­¤æ—¶ i å’Œ j åŒå¤„äºç¬¬ 7 è¡Œï¼Œé‚£ä¹ˆæ˜¾ç„¶ï¼š</p>
<ol>
<li>ä¸¤ä¸ªè¿›ç¨‹éƒ½æƒ³è¦è¿›å…¥ critical sectionï¼Œå³ <code>READY[i]</code> å’Œ <code>READY[j]</code> éƒ½ä¸º <code class="highlight"><span class="nb">true</span></code>ï¼›</li>
<li><code>TURN</code> çš„å€¼ä¸å†ä¼šè¢«æ›´æ”¹ï¼›</li>
<li>ä¸¤ä¸ªè¿›ç¨‹éƒ½å°šæœªè¿›å…¥ critical sectionï¼›</li>
</ol>
<p>ç”±äº <code>TURN</code> å¿…å®šä¹Ÿåªèƒ½ä¸º i æˆ– jï¼Œæ‰€ä»¥ i å’Œ j å¿…ç„¶æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè¿›ç¨‹æ¥ä¸‹æ¥ä¼š break loop å¹¶è¿›å…¥ critical sectionï¼Œåœ¨å®ƒç»“æŸä¹‹å‰ï¼Œå³åœ¨ <code>READY[?]</code> è¢«æ”¹å˜ä¹‹å‰ï¼Œè¯¥æ¡ä»¶æŒç»­æˆç«‹ã€‚</p>
<p>å› æ­¤æˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªç»“è®ºï¼š<u>å¦‚æœæ­¤æ—¶ i å’Œ j åŒå¤„äºç¬¬ä¸ƒè¡Œ</u>ï¼Œi å’Œ j åªæœ‰ä¸€ä¸ªèƒ½è¿›å…¥ critical sectionï¼›å¦å¤–ä¸€ä¸ªåªæœ‰åœ¨å…ˆè¿›å»çš„é‚£ä¸ªé‡Šæ”¾èµ„æºäº†ä»¥åæ‰èƒ½è¿›å»ï¼Œæ‰€ä»¥æ»¡è¶³äº’æ–¥çš„æ¡ä»¶ã€‚</p>
</div>
<p>ç°åœ¨æˆ‘ä»¬è€ƒè™‘ i å·²ç»å…ˆè¡Œè¿è¡Œåˆ°ç¬¬ 7 è¡Œï¼Œè€Œ j è¿˜æ²¡è¿è¡Œåˆ°ç¬¬ 7 è¡Œï¼š</p>
<div class="admonition section">
<p class="admonition-title">Situation 1</p>
<p>å¦‚æœ j è¿˜æ²¡è¿›å…¥ç¬¬ 5 è¡Œï¼Œé‚£ä¹ˆ <code>READY[j]</code> ä¸º <code class="highlight"><span class="nb">false</span></code>ï¼Œæ­¤æ—¶æ²¡æœ‰ç«äº‰ï¼Œi å¯ä»¥ç›´æ¥è¿›å…¥ä¸´ç•Œæ€ã€‚å¹¶ä¸” j ä¹‹åè¿è¡Œåˆ°ç¬¬ 7 è¡Œæ—¶ï¼Œ<code>TURN == &lt;another&gt;</code> å§‹ç»ˆæˆç«‹ã€‚æ‰€ä»¥ j ä½•æ—¶è¿›å…¥ critical section å®Œå…¨å–å†³äº <code>READY[j]</code>ï¼Œå³ j ä½•æ—¶ç¦»å¼€ critical sectionã€‚</p>
<p>æ˜¾ç„¶ï¼Œæ­¤æ—¶æ»¡è¶³äº’æ–¥æ€§è´¨ã€‚</p>
</div>
<div class="admonition section">
<p class="admonition-title">Situation 2</p>
<p>å¦‚æœ j å·²ç»è¿è¡Œå®Œç¬¬ 5 è¡Œï¼Œè¿˜æ²¡æ‰§è¡Œç¬¬ 6 è¡Œï¼Œé‚£ä¹ˆå¯¹äº i æ¥è¯´ï¼Œ<code class="highlight"><span class="p">(</span><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span></code> ä¸º <code class="highlight"><span class="nb">true</span></code>ï¼Œæ­¤æ—¶ i å°†ç­‰å¾… jï¼Œè¿›å…¥ Situation 3ã€‚</p>
</div>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¹ˆ i å’Œ j ä¸ç«äº‰ï¼Œè¦ä¹ˆä¸¤è€…éƒ½è¿è¡Œåˆ°ç¬¬ 7 è¡Œåæ‰ä¼šæœ‰è¿›ç¨‹è¿›å…¥ critical section</p>
<blockquote>
<p>è¿™å°±å¥½åƒä¸¤è€…åœ¨ç¬¬ 6 è¡Œæ¯”è°å…ˆä¸¾æ‰‹ï¼Œç„¶åç­‰ä¸¤è€…éƒ½ä¸¾è¿‡æ‰‹ï¼ˆéƒ½è·‘å®Œç¬¬ 6 è¡Œï¼Œåˆ°è¾¾ç¬¬ 7 è¡Œï¼‰åï¼Œå†åˆ¤æ–­è°è¿›å…¥ critical sectionï¼Œè€Œè¿›å…¥ç¬¬ 7 è¡Œä»¥åæ‰€æœ‰çš„åˆ¤æ–­æ¡ä»¶éƒ½æ˜¯ç›¸å¯¹é™æ­¢çš„ã€ä¸ä¼šå†è¢«ä¿®æ”¹çš„ï¼Œå› è€Œé¿å…ç”šè‡³åˆ©ç”¨äº† race condition å¯¹ selection çš„å½±å“ï¼Œä¿è¯äº†äº’æ–¥çš„æ€§è´¨ã€‚</p>
</blockquote>
</details>
<details class="proof">
<summary>progress</summary>
<p>è¿™æ¡æ€§è´¨çš„æˆç«‹æ¯”è¾ƒç¬¦åˆç›´è§‰ï¼Œå”¯ä¸€éœ€è¦è¯´æ˜çš„å°±æ˜¯ä¸ä¼šå‡ºç°ä¸¤ä¸ªè¿›ç¨‹åŒæ—¶åœ¨ <code>while ()</code> è¢«é˜»å¡ä½çš„æƒ…å†µã€‚ä½†æ˜¯è¿™ç‚¹éå¸¸æ˜¾ç„¶ï¼Œ<code class="highlight"><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span></code> å¿…ç„¶æ˜¯ falseï¼Œæ‰€ä»¥ä¸¤ä¸ªå¾ªç¯æ€»æœ‰ä¸€ä¸ªä¼šè¢« breakã€‚</p>
</details>
<details class="proof">
<summary>bounded waiting time</summary>
<p>åœ¨ Peterson's ä¸­ï¼Œç­‰å¾…æ—¶é—´ä¸»è¦æŒ‡è¿™éƒ¨åˆ†çš„è¿è¡Œæ—¶é—´ï¼Œå°¤å…¶æŒ‡ç¬¬ä¸ƒè¡Œçš„ <code>while</code> å¾ªç¯ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// `i` is 0 or 1, indicating current pid, while `j` is another pid.</span>
<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>

<span class="hll"><span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                    </span><span class="c1">// â”</span>
</span><span class="hll"><span class="w">    </span><span class="n">TURN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w">                           </span><span class="c1">// â”‚</span>
</span><span class="hll"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">    </span><span class="c1">// â”œ entry section</span>
</span><span class="w">        </span><span class="c1">// i.e. wait until:             // â”‚</span>
<span class="w">        </span><span class="c1">//  (1) j exits,                // â”‚</span>
<span class="w">        </span><span class="c1">//  (2) j is slower, so it      // â”‚</span>
<span class="w">        </span><span class="c1">//      should run now.         // â”˜</span>

<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">    </span><span class="c1">// - critical section</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                   </span><span class="c1">// - exit section</span>

<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                  </span><span class="c1">// - remainder section</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œä¸æ–­å¾ªç¯çš„æ¡ä»¶æ˜¯ï¼š<code class="highlight"><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span></code>ï¼Œå¦‚æœè¯¥å¾ªç¯ä¸€å¼€å§‹å°±ä¸æˆç«‹ï¼Œé‚£ä¹ˆæ˜¾ç„¶æ˜¯ç¬¦åˆ bounded waiting time çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘è¿™ä¸ªæ¡ä»¶æœ€å¤šèƒ½æŒç»­å¤šä¹…ã€‚</p>
<div class="admonition section">
<p class="admonition-title">A. <code class="highlight"><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></code> ä¸º <code class="highlight"><span class="nb">true</span></code></p>
<p>è¿™éœ€è¦ process j å·²ç»è¿è¡Œè¿‡ç¬¬ 5 è¡Œï¼Œå¹¶ä¸”è¿˜æ²¡è¿è¡Œç¬¬ 15 è¡Œï¼Œå³ process j ä¹Ÿ<strong>æƒ³è¦</strong>è¿›å…¥ä¸´ç•Œæ€ã€‚</p>
<p>è¿™ä¸€æ¡æ˜¯åœ¨åˆ¤æ–­æ˜¯å¦æœ‰å†²çªå­˜åœ¨ï¼Œå¦‚æœç°åœ¨åªæœ‰ process i æƒ³è¦è¿›å…¥ä¸´ç•Œæ€ï¼Œé‚£æ— éœ€ç­‰å¾…ç›´æ¥è¿›å…¥å³å¯ã€‚é€šè¿‡<strong>æ”¹å˜è¿™ä¸ªæ¡ä»¶</strong>è€Œè¿›å…¥ä¸´ç•Œæ€æœ‰ä¸¤ç§å¯èƒ½ï¼š</p>
<ol>
<li>ä¸€å¼€å§‹å†²çªå°±ä¸å­˜åœ¨ï¼›</li>
<li>process j åˆšç¦»å¼€ä¸´ç•Œæ€ï¼Œé‡Šæ”¾äº†ä¸´ç•Œèµ„æºï¼›</li>
</ol>
</div>
<div class="admonition section">
<p class="admonition-title">B. <code class="highlight"><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span></code> ä¸º <code class="highlight"><span class="nb">true</span></code></p>
<p>æœ‰ä¸¤ç§å¯èƒ½ï¼š</p>
<ol>
<li>process j è¿˜æ²¡è¿è¡Œç¬¬ 6 è¡Œï¼›</li>
<li>process j åœ¨ process i ä¹‹å‰å°±è¿è¡Œäº†ç¬¬ 6 è¡Œï¼›</li>
</ol>
<p>å¯¹äºç¬¬ä¸€ç§æƒ…å†µï¼Œç”±äº A. æˆç«‹åæ‰ä¼šåˆ¤æ–­è¿™æ¡ï¼Œæ‰€ä»¥ process j çš„çŠ¶æ€å…¶å®æ˜¯åˆšè¿è¡Œå®Œç¬¬ 5 è¡Œè¿˜æ²¡è¿è¡Œå®Œç¬¬ 6 è¡Œï¼Œæ˜¾ç„¶è¿™ä¸ªæ—¶é—´æ˜¯æœ‰ç•Œçš„ã€‚</p>
<p>è€Œå¯¹äºç¬¬äºŒç§æƒ…å†µï¼Œè¯´æ˜ i æ˜¯åæ¥è€…ï¼Œj å·²ç»å®¢æ°”è¿‡ä¸€æ¬¡äº†ï¼Œæ‰€ä»¥åº”å½“è®© j è¿è¡Œï¼Œi ç­‰å¾… j ç¦»å¼€ä¸´ç•Œæ€é‡Šæ”¾èµ„æºï¼Œæ­¤æ—¶é€šè¿‡ A.2. æ¥è¿›å…¥ä¸´ç•Œæ€ã€‚è€Œ process j æ“ä½œä¸´ç•Œèµ„æºçš„æ—¶é—´ä¹Ÿåº”å½“æœ‰é™çš„ã€‚</p>
</div>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œwaiting time çš„æœ€å¤§å€¼åŸºæœ¬ä¸Šå–è‡ªï¼š</p>
<ol>
<li>process j æ‰§è¡Œç¬¬ 6 è¡Œçš„æ—¶é—´ï¼›</li>
<li>process j æ“ä½œä¸´ç•Œèµ„æºçš„æ—¶é—´ï¼›</li>
</ol>
<p>é€šè¿‡ä¹‹å‰çš„è®ºè¿°æˆ‘ä»¬çŸ¥é“ï¼Œè¿™ä¸¤ä¸ªéƒ½æ˜¯æœ‰ç•Œçš„ï¼Œäºæ˜¯è¯¥æ€§è´¨å¾—è¯ã€‚</p>
</details>
<div class="admonition bug">
<p class="admonition-title">Oops!</p>
<p>ä½†æ˜¯ï¼Œ<strong>Peterson's å®é™…ä¸Šæ— æ³•é€‚ç”¨äºç°ä»£è®¡ç®—æœºä¸­</strong>ã€‚ä¸Šè¿°åšæ³•æœ‰ä¸€ä¸ªå…³é”®ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬åœ¨è¯æ˜è¿‡ç¨‹ä¸­ä¸€ç›´é»˜è®¤æˆç«‹çš„äº‹æƒ…ï¼šè¿›ç¨‹æ€»æ˜¯å…ˆæ‰§è¡Œ <code>READY[i] = true;</code>ï¼Œç„¶åæ‰ä¼šæ‰§è¡Œ <code>TURN = j;</code>ï¼Œå³å…ˆè¿›å…¥å°±ç»ªæ€ï¼Œå†ç´¢å–ä¸´ç•Œèµ„æºï¼Œè¿™çœ‹èµ·æ¥æ˜¯ä¸ªéå¸¸åˆç†çš„æ¡ä»¶ã€‚ä½†åœ¨ç°ä»£è®¡ç®—æœºä¸­ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šé€šè¿‡é‡æ’åˆ—éƒ¨åˆ†è¯­å¥æ¥æ›´å¥½åœ°åˆ©ç”¨ CPU èµ„æºï¼ˆå‚è€ƒè®¡ç»„çš„<a href="https://xuan-insr.github.io/computer_organization/4_processor/#422-structure-hazards" target="_blank">å„ç§ç«äº‰</a>ï¼‰ã€‚è€Œ<strong>å¯¹ç¼–è¯‘å™¨æ¥è¯´</strong>ï¼Œè¿™ä¸¤ä¸ªæ“ä½œï¼ˆå°±ç»ªå’Œè¯·æ±‚ï¼‰å¹¶æ²¡æœ‰æ“ä½œç›¸åŒå†…å®¹ï¼Œå› è€Œäº¤æ¢é¡ºåºæ˜¯ä¸ä¼šå½±å“ç»“æœçš„ï¼Œæ‰€ä»¥å¯èƒ½è¢«ç¼–è¯‘å™¨äº¤æ¢ã€‚è€Œè¿™å°±æœ‰å¯èƒ½å¯¼è‡´å‡ºç°é—®é¢˜ï¼Œä¾‹å¦‚ï¼š</p>
<p><figure markdown="">
<center> <a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="100%" href="../img/23.png"><img alt="" src="../img/23.png"/></a> </center>
The effects of instruction reordering in Petersonâ€™s solution.
</figure></p>
<p>åœ¨æ£•è‰²æ ‡è®°æ—¶åˆ»ï¼Œprocess 1 è¿›è¡Œ <code>while</code> å¾ªç¯åˆ¤æ–­ï¼Œå‘ç° <code>READY[0]</code> ä¸º <code class="highlight"><span class="nb">false</span></code>ï¼Œä½†æ­¤æ—¶ <code>TURN</code> æŒ‡å‘å¯¹æ–¹ï¼Œæ‰€ä»¥æŒ‰ç…§æˆ‘ä»¬å…ˆå‰çš„åˆ†æï¼Œæ­¤æ—¶ process 1 ä¼šè®¤ä¸º process 0 æ˜¯å·²ç»è¿è¡Œå®Œ critical sectionï¼Œå·²ç»é‡Šæ”¾äº†ä¸´ç•Œèµ„æºï¼Œæ‰€ä»¥è¿›å…¥ä¸´ç•Œæ€ï¼›ç„¶è€Œï¼Œåœ¨ç»¿è‰²æ ‡è®°æ—¶åˆ»ï¼Œå¯¹äº process 0ï¼Œæ­¤æ—¶ <code>TURN</code> æŒ‡å‘è‡ªå·±ï¼Œprocess 1 è¿˜æ²¡è¿è¡Œå®Œæ‰€ä»¥ <code>READY[1]</code> è¿˜æ˜¯ <code class="highlight"><span class="nb">true</span></code>ï¼Œæ ¹æ®æˆ‘ä»¬ä¹‹å‰çš„åˆ†æï¼Œæ­¤æ—¶ process 0 ä¼šè®¤ä¸º process 1 åœ¨ç­‰å¾…è‡ªå·±ï¼Œæ‰€ä»¥ä¹Ÿè¿›å…¥äº†ä¸´ç•Œæ€ã€‚äºæ˜¯ï¼Œä¸¤ä¸ªè¿›ç¨‹åŒæ—¶è¿›å…¥äº†ä¸´ç•Œæ€ï¼Œè¿åäº† mutual exclusion çš„æ€§è´¨ã€‚</p>
</div>
<p>æ‰€ä»¥ï¼Œå®é™…ä¸Š Peterson's Algorithm ä»ç„¶æ²¡æœ‰è§£å†³é—®é¢˜ã€‚</p>
<h2 id="memory-barriers">Memory Barriers<a class="headerlink" href="#memory-barriers" title="Permanent link">Â¶</a></h2>
<p>è¯¥æ–¹æ³•å®é™…ä¸Šæ˜¯å¯¹ä¸Šè¿°è½¯ä»¶æ–¹æ³•çš„è¡¥è¶³ã€‚æˆ‘ä»¬å…ˆå‰æåˆ°ï¼ŒPeterson's Algorithm å¤±æ•ˆçš„åŸå› æ˜¯ç¼–è¯‘å™¨ä¼šæ ¹æ®éœ€æ±‚é‡æ’åˆ—ä¸€äº›å†…å­˜æ“ä½œï¼Œè€Œ memory barriers ä¿è¯ barrier ä¹‹å‰çš„ S/L æŒ‡ä»¤å¿…é¡»åœ¨ barrier ä¹‹åçš„ S/L æŒ‡ä»¤ä¹‹å‰å®Œæˆï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸»åŠ¨ç¦æ­¢ç¼–è¯‘å™¨åšè¿™ç§é‡æ’ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// `i` is 0 or 1, indicating current pid, while `j` is another pid.</span>
<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                    </span><span class="c1">// â”</span>
<span class="hll"><span class="w">    </span><span class="n">memory_barrier</span><span class="p">();</span><span class="w">                   </span><span class="c1">// â”‚</span>
</span><span class="w">    </span><span class="n">TURN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">;</span><span class="w">                           </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">READY</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">TURN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">    </span><span class="c1">// â”œ entry section</span>
<span class="w">        </span><span class="c1">// i.e. wait until:             // â”‚</span>
<span class="w">        </span><span class="c1">//  (1) j exits,                // â”‚</span>
<span class="w">        </span><span class="c1">//  (2) j is slower, so it      // â”‚</span>
<span class="w">        </span><span class="c1">//      should run now.         // â”˜</span>

<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">    </span><span class="c1">// - critical section</span>

<span class="w">    </span><span class="n">READY</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                   </span><span class="c1">// - exit section</span>

<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                  </span><span class="c1">// - remainder section</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<hr/>
<div class="admonition definition">
<p class="admonition-title">Memory Model</p>
<p>ä¸åŒçš„è®¡ç®—æœºæ¶æ„å¯èƒ½ä¼šå¯¹ç”¨æˆ·ç¨‹åºæ“ä½œå†…å­˜çš„ä¿è¯æœ‰æ‰€ä¸åŒï¼Œè¿™ç§ä¿è¯è¢«ç§°ä¸º memory modelã€‚æˆ‘ä»¬å¯ä»¥å°†å®ƒåˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p>
<ol>
<li>å¼ºæœ‰åº(strongly ordered)ï¼šè¿›ç¨‹å¯¹å†…å­˜åšçš„ä¿®æ”¹ç«‹åˆ»å¯¹å…¶å®ƒå¤„ç†å™¨å¯è§ï¼›</li>
<li>å¼±æœ‰åº(weakly ordered)ï¼šè¿›ç¨‹å¯¹å†…å­˜åšçš„ä¿®æ”¹ä¸ç«‹åˆ»å¯¹å…¶å®ƒå¤„ç†å™¨å¯è§ï¼›</li>
</ol>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸ºäº†æé«˜å†…å­˜æ“ä½œçš„æ•ˆç‡ï¼Œæˆ‘ä»¬å¼•å…¥äº† cacheï¼Œåœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹ï¼Œcache æœºåˆ¶çš„å­˜åœ¨å¯èƒ½å¯¼è‡´è¿›ç¨‹ A å¯¹å†…å­˜çš„å†™æ— æ³•å¯¹è¿›ç¨‹ B ç«‹åˆ»å¯è§ï¼Œè¿™å°±æ˜¯å¼±æœ‰åºçš„ä¸€ç§ä½“ç°ã€‚</p>
<details class="extra" open="open">
<summary>è¡¥å……ææ–™</summary>
<p>æ„Ÿè°¢ <a href="https://github.com/27rabbitlt" target="_blank">ltgg</a> æä¾›çš„å‚è€ƒèµ„æ–™ï¼Œè¯»è€…æœ‰å…´è¶£å¯ä»¥è‡ªè¡Œé˜…è¯»ï¼š</p>
<ul>
<li><a href="https://preshing.com/20121019/this-is-why-they-call-it-a-weakly-ordered-cpu/" target="_blank">This Is Why They Call It a Weakly-Ordered CPU</a></li>
<li>â­ï¸ <a href="https://preshing.com/20120930/weak-vs-strong-memory-models/" target="_blank">Weak vs. Strong Memory Models</a></li>
</ul>
<blockquote>
<p>å…³äºå¼ºå¼±çš„å®šä¹‰ï¼Œå¤§è‡´çš„æ„æ€æ˜¯ï¼š</p>
<p>A strong hardware memory model is one in which every machine instruction comes implicitly with acquire and release semantics. As a result, when one CPU core performs a sequence of writes, every other CPU core sees those values change in the same order that they were written.</p>
</blockquote>
</details>
</div>
<blockquote>
<p>è¿™éƒ¨åˆ†æˆ‘æ²¡æœ‰å®Œå…¨ææ¸…æ¥šï¼Œä¹¦æœ¬çš„é€»è¾‘éå¸¸çš„è¯¡å¼‚ï¼šä¹¦æœ¬è®¤ä¸º memory barrier æ˜¯å¼±æœ‰åºé—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯æˆ‘å§‹ç»ˆæ²¡æ˜ç™½å®ƒä»¬ä¹‹é—´çš„é€»è¾‘åœ¨å“ªé‡Œï¼Œä»¥åŠâ€œæœ‰åºâ€å’Œâ€œç«‹åˆ»å¯è§â€çš„æ ¹æœ¬è”ç³»åœ¨å“ªé‡Œã€‚è¿™é‡Œä¸€å®šæ˜¯å­˜åœ¨ä¸æ¸…æ¥šçš„åœ°æ–¹çš„ã€‚ä½†æ˜¯è¿™éƒ¨åˆ†çœ‹èµ·æ¥ä¸æ˜¯å¾ˆé‡è¦ï¼Œæ‰€ä»¥æˆ‘å°±å…ˆæ”¾ç€ä¸ç®¡äº†ã€‚</p>
</blockquote>
<h2 id="hardware-instructions">Hardware Instructions<a class="headerlink" href="#hardware-instructions" title="Permanent link">Â¶</a></h2>
<p>è®¨è®º Peterson's Algorithm åæˆ‘ä»¬åº”å½“æ„è¯†åˆ°ï¼ŒåŒæ­¥é—®é¢˜çš„å‡ºç°æ˜¯ â“µ ç¡¬ä»¶æ“ä½œæ•°æ®éœ€è¦æ—¶é—´ï¼Œä¸ â“¶ æ•°æ®å…·æœ‰å…±äº«æ€§çš„ä¸åè°ƒï¼Œæ‰€ä»¥æœ¬è´¨ä¸Šæ˜¯ç¡¬ä»¶äº§ç”Ÿçš„é—®é¢˜ã€‚å› è€Œï¼Œè¦æƒ³æ›´å¥½çš„è§£å†³é—®é¢˜ï¼Œæˆ‘ä»¬è¿˜æ˜¯åº”å½“ä»ç¡¬ä»¶å‡ºå‘ã€‚æˆ‘ä»¬åœ¨è¿™é‡Œå¼•å…¥<strong>åŸå­æ€§(atomic)</strong>è¿™ä¸ªæ¦‚å¿µï¼Œå®ƒçš„åŸºæœ¬é€»è¾‘æ˜¯è®©â€œéœ€è¦æ—¶é—´çš„ï¼Œå¯¹æ•°æ®çš„æ“ä½œâ€ï¼Œå˜æˆä¸€ä¸ªâ€œåœ¨æ—¶é—´ä¸Šä¸å¯åˆ†å‰²ã€ä¸å¯è¢«æ‰“æ–­çš„ï¼Œå³åŸå­æ€§çš„æ“ä½œâ€ã€‚ä¸åŒç¡¬ä»¶å¯èƒ½æä¾›ä¸åŒçš„åŸå­æ€§æ“ä½œï¼Œæˆ‘ä»¬è¿™é‡Œå°†å®ƒä»¬æŠ½è±¡ä¸º <code>test_and_set()</code> å’Œ <code>compare_and_swap()</code> ä¸¤ç±»æ¥ä»‹ç»ã€‚</p>
<h3 id="test_and_set"><code>test_and_set()</code><a class="headerlink" href="#test_and_set" title="Permanent link">Â¶</a></h3>
<div class="admonition quote">
<p class="admonition-title">Links</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Test-and-set" target="_blank">Wikipedia</a></li>
</ul>
</div>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="n">atomic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">test_and_set</span><span class="p">(</span><span class="kt">bool</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">target</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>è¯¥æŒ‡ä»¤çš„åŠŸèƒ½å°±ç±»ä¼¼ä¸Šé¢è¿™æ®µä»£ç ï¼šå°†ç›®æ ‡è®¾ä¸º <code class="highlight"><span class="nb">true</span></code>ï¼ŒåŒæ—¶è¿”å›å…¶æ—§å€¼ã€‚ä½†é™¤æ­¤ä¹‹å¤–ï¼Œè¿™ä¸ªæŒ‡ä»¤éœ€è¦ä¿è¯<strong>åŸå­æ€§</strong>ï¼Œå³å¦‚æœæœ‰è‹¥å¹² <code>test_and_set()</code> åŒæ—¶å‘ç”Ÿï¼Œé‚£ä¹ˆæ— è®ºå¹¶å‘è¿˜æ˜¯å¹¶è¡Œï¼Œå®ƒä»¬éƒ½åº”å½“ä¸€ä¸ªä¸€ä¸ªåœ°æ‰§è¡Œï¼Œè€Œä¸èƒ½äº§ç”Ÿæ—¶é—´ä¸Šçš„äº¤é›†ã€‚</p>
<p>å¯ä»¥å‘ç°ï¼Œè¿™ç§ atomic çš„æ“ä½œå¤©ç„¶ä¿è¯äº† mutual exclusionï¼Œå› è€Œå¯¹äºå®ç°äº† <code>test_and_set()</code> çš„æœºå™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>test_and_set()</code> æ¥è§£å†³ CS é—®é¢˜ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">test_and_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">LOCK</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">    </span><span class="c1">// - entry section</span>
</span>
<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">    </span><span class="c1">// - critical section</span>

<span class="w">    </span><span class="n">LOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                       </span><span class="c1">// - exit section</span>

<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                  </span><span class="c1">// - remainder section</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>åœ¨ç¬¬ 3 è¡Œï¼Œå¾ªç¯ç­‰å¾…çš„æ¡ä»¶å˜ä¸º <code class="highlight"><span class="n">test_and_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">LOCK</span><span class="p">)</span></code>ï¼Œå¦‚æœ <code>LOCK</code> çš„æ—§å€¼æ˜¯ <code class="highlight"><span class="nb">false</span></code>ï¼Œåˆ™å¯ä»¥ç»§ç»­ï¼Œå¹¶ä¸”æ­¤æ—¶ <code>LOCK</code> çš„å€¼è¢«åŸå­æ€§åœ°ä¿®æ”¹ä¸º <code class="highlight"><span class="nb">true</span></code>ï¼›è€Œå¦‚æœ <code>LOCK</code> çš„æ—§å€¼æ˜¯ <code class="highlight"><span class="nb">true</span></code>ï¼Œé‚£ä¹ˆå®ƒç»è¿‡ <code class="highlight"><span class="n">test_and_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">LOCK</span><span class="p">)</span></code> åçš„å€¼ä»ç„¶æ˜¯ <code class="highlight"><span class="nb">true</span></code>ï¼Œä¸”éœ€è¦ç­‰å¾…ï¼Œç›´åˆ°ï¼šå°† <code>LOCK</code> æ”¹æˆ <code class="highlight"><span class="nb">true</span></code> çš„é‚£ä¸ªè¿›ç¨‹åœ¨ exit section å°† <code>LOCK</code> æ”¹å› <code class="highlight"><span class="nb">false</span></code>ï¼Œå³é‡Šæ”¾é”ã€‚</p>
<p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œä¸æˆ‘ä»¬è®¨è®º Peterson's Algorithm æ—¶çš„è¯­å¢ƒä¸åŒï¼Œæˆ‘ä»¬ç°åœ¨ä¸å†å‡è®¾å‚ä¸ç«äº‰çš„è¿›ç¨‹åªæœ‰ä¸¤ä¸ªï¼ˆè¿™æ˜¯ Peterson's çš„å±€é™æ€§ä¹‹ä¸€ï¼‰ã€‚åœ¨è¿™ä¸ªè¯­å¢ƒä¸‹ï¼Œæˆ‘ä»¬å†æ¥è€ƒè™‘å®ƒæ˜¯å¦æ»¡è¶³<a href="#r4s2csp" target="_blank">ä¸‰æ¡æ€§è´¨</a>ã€‚</p>
<div class="admonition proof">
<p class="admonition-title">mutual exclusion</p>
<p>ç”±äº <code class="highlight"><span class="n">test_and_set</span><span class="p">()</span></code> æ˜¯åŸå­æ€§çš„ï¼Œæ‰€ä»¥åŒæ—¶æ‰§è¡Œçš„ä¸€ç³»åˆ— <code class="highlight"><span class="n">test_and_set</span><span class="p">()</span></code> ä¸­ï¼Œåªæœ‰ä¸€ä¸ªèƒ½è¿”å› <code class="highlight"><span class="nb">false</span></code>ï¼Œå³åªæœ‰ä¸€ä¸ªèƒ½é€šè¿‡é”ï¼Œå› è€Œå¤©ç”Ÿæ»¡è¶³äº† mutual exclusionã€‚</p>
</div>
<div class="admonition proof">
<p class="admonition-title">progress</p>
<p>ä»£ç ä¸­å¯¹ <code>LOCK</code> çš„ä¿®æ”¹æ“ä½œæ˜¯é—­åˆçš„ï¼Œå³è¿›å…¥ critical section ä¼šå¯¼è‡´ <code>LOCK</code> å˜ä¸º <code class="highlight"><span class="nb">false</span></code>ï¼Œä½†ç¦»å¼€ critical section å¿…å®šå¯¼è‡´ <code>LOCK</code> å˜ä¸º <code class="highlight"><span class="nb">true</span></code>ã€‚å› æ­¤ï¼Œåªè¦æ²¡æœ‰è¿›ç¨‹å¤„äº critical sectionï¼Œé‚£ä¹ˆ <code>LOCK</code> å¿…å®šä¸º <code class="highlight"><span class="nb">false</span></code>ï¼Œåˆ™ä¸€å®šæœ‰å°±ç»ªçš„è¿›ç¨‹èƒ½å¤Ÿè¿›å…¥ critical sectionï¼Œè€Œè¿è¡Œ critical section çš„æ—¶é—´æ˜¯æœ‰é™çš„ï¼Œå› æ­¤ <code>LOCK</code> åˆä¸€å®šä¼šåœ¨æœ‰é™æ—¶é—´å†…å˜ä¸º <code class="highlight"><span class="nb">false</span></code>ï¼Œä»è€Œæ»¡è¶³ progressã€‚</p>
</div>
<div class="admonition bug">
<p class="admonition-title">bounded waiting time</p>
<p>å¦‚æœåªæœ‰ä¸¤ä¸ªè¿›ç¨‹å‚ä¸ç«äº‰ï¼Œé‚£ä¹ˆé€šè¿‡ç±»ä¼¼è¯æ˜ progress çš„è¿‡ç¨‹å¯ä»¥å¾—åˆ° bounded waiting time æ˜¯å¯ä»¥æˆç«‹çš„ã€‚A ç¦»å¼€ä¸´ç•Œæ€åå¤„äºå°±ç»ªæ€ç­‰å¾…çš„ B ç«‹åˆ»å°±èƒ½è¿›å…¥ critical sectionï¼Œå³åªæœ‰ä¸¤ä¸ªäººæ’é˜Ÿæ˜¯ä¸ä¼šè¢«æ’é˜Ÿçš„ã€‚</p>
<p>ä½†åœ¨å‚ä¸ç«äº‰çš„è¿›ç¨‹å˜å¤šä»¥åï¼Œå°±å¾ˆæœ‰å¯èƒ½å‡ºç°ç±»ä¼¼äºè°ƒåº¦ä¸­â€œé¥¥é¥¿â€çš„ç°è±¡ï¼š</p>
<div class="highlight"><pre><span></span><code>    â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”      
P0  â”‚ CS â”‚   â”€â”€â”€â”¤ CS â”‚   â”€â”€â”€â”¤ CS â”‚   â”€â”€â”€â”¤ CS â”‚   â”€â”€â”€ Â·Â·Â·
    â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜      
          â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”
P1  â”€â”€â”€â”€â”€â”€â”¤ CS â”‚   â”€â”€â”€â”¤ CS â”‚   â”€â”€â”€â”¤ CS â”‚   â”€â”€â”€â”¤ CS â”‚ Â·Â·Â·
          â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”˜

P2  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Â·Â·Â·
</code></pre></div>
<p>å¯ä»¥å‘ç°ï¼Œç”±äº <code>P0</code> å’Œ <code>P1</code> æ€»æ˜¯è½®æµè·å¾—é”ï¼Œå¯¼è‡´ <code>P2</code> å§‹ç»ˆå¤„äºå°±ç»ªæ€ç­‰å¾…é”ï¼Œå› è€Œå¯¹äº <code>P2</code> æ¥è¯´ waiting time å°±ä¸å†æœ‰é™äº†ã€‚</p>
</div>
<p>ç³Ÿäº†ï¼Œçœ‹èµ·æ¥å¾ˆé…·çš„ä¸€ä¸ªæ–¹æ³•è²Œä¼¼ä¸èƒ½æ»¡è¶³ CS è§£æ³•çš„æ€§è´¨ï¼Œä½†ä»”ç»†åˆ†æï¼Œè¿™æ˜¯ç”±äºé”çš„åˆ†é…æœºåˆ¶æ˜¯ä¸å¯æ§çš„â€”â€”åœ¨ä¸€ä¸ªé”è¢«é‡Šæ”¾åï¼Œæ¥ä¸‹æ¥å°†æ‹¿åˆ°é”çš„è¿›ç¨‹åº”å½“æ˜¯æ¥ä¸‹æ¥ç¬¬ä¸€ä¸ªå®é™…æ‰§è¡Œ <code>test_and_set()</code> çš„è¿›ç¨‹ï¼Œç„¶è€Œç”±äº â“µ æˆ‘ä»¬å¯¹æ¯ä¸ªè¿›ç¨‹çš„è¿è¡Œé€Ÿåº¦ï¼Œä¸åº”å½“æœ‰å‡è®¾ï¼Œâ“¶ æˆ‘ä»¬å¯¹åŒæ—¶äº§ç”Ÿçš„ <code>test_and_set()</code> å°†æŒ‰ä½•é¡ºåºè¢«å¤„ç†ï¼Œä¸åº”å½“æœ‰å‡è®¾ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨ç”¨æŸç§æ–¹æ³•æ¥å®ç°è¿™ç§â€œé”çš„è°ƒåº¦â€ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// `i` is process id in [0, n), where `n` is the count of related process. </span>
<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">WAITING</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w">                                  </span><span class="c1">// â”</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">WAITING</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">test_and_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">LOCK</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">      </span><span class="c1">// â”œ entry sec.</span>
<span class="w">                                                        </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="n">WAITING</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                                 </span><span class="c1">// â”˜</span>

<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">                    </span><span class="c1">// - critical sec.</span>

<span class="w">    </span><span class="c1">// i.e. find next waiting process j                 // â”</span>
<span class="w">    </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">                                    </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">WAITING</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="w"> </span><span class="p">{</span><span class="w">                     </span><span class="c1">// â”œ exit sec.</span>
<span class="w">        </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="n">n</span><span class="p">;</span><span class="w">                                </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="p">}</span><span class="w">                                                   </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="c1">// release j's LOCK or release whole LOCK           // â”‚</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">)</span><span class="w">     </span><span class="n">LOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                       </span><span class="c1">// â”‚</span>
<span class="w">    </span><span class="k">else</span><span class="w">            </span><span class="n">WAITING</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                 </span><span class="c1">// â”˜</span>

<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                                  </span><span class="c1">// - remainder sec.</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>æˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ª <code class="highlight"><span class="n">WAITING</span><span class="p">[]</span></code> æ•°ç»„æ¥è¾…åŠ© <code>LOCK</code> ç»†åŒ–é”çš„ç²’åº¦ï¼Œæ­¤æ—¶ <code>LOCK</code> è¡¨ç¤ºçš„â€œæ˜¯å¦å­˜åœ¨ç«äº‰â€ï¼Œè€Œ <code class="highlight"><span class="n">WAITING</span><span class="p">[]</span></code> åˆ™æ ‡è¯†äº†æ‰€æœ‰æ­£åœ¨ç­‰å¾…çš„è¿›ç¨‹ã€‚åŒºåˆ«äºä¹‹å‰ç›´æ¥é‡Šæ”¾æ•´ä¸ªé”ï¼Œè®©å‰©ä¸‹çš„è¿›ç¨‹å»â€œæ‹¼æ‰‹é€Ÿâ€ï¼Œæˆ‘ä»¬è¿™æ¬¡ç”±é‡Šæ”¾é”çš„è¿›ç¨‹æ¥é€‰æ‹©ä¸‹ä¸€ä¸ªè¿›å…¥ critical section çš„æ˜¯è°ã€‚</p>
<p>åœ¨ 11-14 è¡Œï¼Œé€šè¿‡ä¸€ä¸ªå¾ªç¯æ‰¾åˆ°ä¸‹ä¸€ä¸ª <code class="highlight"><span class="n">WAITING</span><span class="p">[</span><span class="n">j</span><span class="p">]</span></code> ä¸º <code class="highlight"><span class="nb">true</span></code> çš„ jï¼Œâ“µ å¦‚æœæ‰¾åˆ°äº†è¿™ä¸ª jï¼Œé‚£ä¹ˆå°±å°† <code>WAITING[j]</code> è®¾ä¸º <code class="highlight"><span class="nb">false</span></code>ï¼ˆ19 è¡Œï¼‰ï¼Œè¿™æ · j é©¬ä¸Šå°±ä¼šåœ¨ç¬¬ 4 è¡Œ breakï¼Œè¿›å…¥ critical sectionï¼›â“¶ è€Œå¦‚æœæ‰¾ä¸åˆ°è¿™ä¸ª jï¼Œå³æ‰¾äº†ä¸€åœˆåˆæ‰¾å›äº† iï¼Œé‚£ä¹ˆè¯´æ˜ i æ˜¯æœ€åä¸€ä¸ªäº†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é‡Šæ”¾æ•´ä¸ªé”ï¼ˆ17 è¡Œï¼‰ã€‚</p>
<p>é€šè¿‡ä½¿ç”¨è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬ä¿è¯äº†ç­‰å¾…ä¸­çš„è¿›ç¨‹æœ€å¤šåªéœ€è¦ç­‰å¾… n-1 ä¸ªè¿›ç¨‹è¿è¡Œå®Œ critical sectionï¼ˆç±»ä¼¼äºå®ç°äº†â€œFCFSâ€ï¼‰ã€‚</p>
<h3 id="compare_and_swap"><code>compare_and_swap()</code><a class="headerlink" href="#compare_and_swap" title="Permanent link">Â¶</a></h3>
<div class="admonition quote">
<p class="admonition-title">Links</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Compare-and-swap">Wikipedia</a></li>
</ul>
</div>
<p><code>compare_and_swap()</code> ä¹Ÿè¢«ç®€å†™ä¸º CAS æŒ‡ä»¤ï¼Œå®ƒçš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&lt;</span><span class="n">atomic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">compare_and_swap</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">expected</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">new_val</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">target</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// *target = (*target == expected) ? new_val : *target;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">expected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="o">*</span><span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_val</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ret</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>CAS æ¥å—ä¸‰ä¸ªå€¼ï¼š</p>
<ol>
<li><code>target</code> å¾…ä¿®æ”¹çš„æ•°æ®çš„åœ°å€ï¼›</li>
<li><code>expected</code> é¢„æœŸä¸­å¾…ä¿®æ”¹çš„æ•°æ®çš„æ—§å€¼ï¼›</li>
<li><code>new_val</code> å¸Œæœ›å°†æ•°æ®ä¿®æ”¹ä¸ºçš„æ–°å€¼ï¼›</li>
</ol>
<p>è€Œå½“ä¸”ä»…å½“ <code>*target</code> ç¬¦åˆé¢„æœŸï¼Œä¸ <code>expected</code> ç›¸åŒæ—¶å€™ï¼Œæ‰ä¼šå°†å®ƒæ”¹ä¸º <code>new_val</code>ã€‚åŒæ ·ï¼ŒCAS ä¹Ÿåº”å½“ä¿è¯åŸå­æ€§ï¼Œå³è‹¥å¹² CAS åŒæ—¶å‘ç”Ÿæ—¶ï¼Œä¹Ÿåº”å½“ä¸€ä¸ªä¸€ä¸ªçš„æ‰§è¡Œï¼Œè€Œä¸èƒ½å­˜åœ¨æ—¶é—´ä¸Šçš„äº¤é›†ã€‚</p>
<p>æˆ‘ä»¬æ³¨æ„åˆ°ï¼Œå®é™…ä¸Š <code class="highlight"><span class="n">test_and_set</span><span class="p">(</span><span class="n">target</span><span class="p">)</span></code> å°±æ˜¯ <code class="highlight"><span class="n">compare_and_swap</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">)</span></code>ï¼Œå› è€Œå®é™…ä¸Š CAS è§£å†³ CS é—®é¢˜çš„æ–¹æ³•ä»¥åŠé—®é¢˜å’Œä¸Šä¸€èŠ‚çš„å†…å®¹æ²¡ä»€ä¹ˆå·®åˆ«ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œ<code>compare_and_swap()</code> ç›¸æ¯”äº <code>test_and_set()</code>ï¼Œæ˜¾ç„¶æœ‰æ›´å¤§çš„æ“ä½œç©ºé—´ï¼Œä¹Ÿæ›´æ³›ç”¨ï¼Œè€ƒè™‘åˆ° CAS æŒ‡ä»¤è‡ªèº«å·²ç»èƒ½å¤Ÿæ”¯æŒåŸå­æ€§çš„ä¿®æ”¹å€¼ï¼Œæˆ‘ä»¬è€ƒè™‘èƒ½å¦è·³å‡º CS é—®é¢˜çš„èŒƒå¼æ¥è€ƒè™‘é—®é¢˜ã€‚</p>
<h2 id="atomic-variables">Atomic Variables<a class="headerlink" href="#atomic-variables" title="Permanent link">Â¶</a></h2>
<p><strong>åŸå­å˜é‡(atomic variables)</strong>æ˜¯ä¸€ç§ç”¨åŸå­æ€§æ“ä½œç»´æŠ¤çš„å˜é‡ã€‚æˆ‘ä»¬æ‰€æœ‰å¯¹åŸå­å˜é‡çš„æ“ä½œå¯ä»¥é€šè¿‡ CAS æ¥å®ç°ï¼Œä¾‹å¦‚è‡ªå¢æ“ä½œï¼š</p>
<div class="highlight"><pre><span></span><code><span class="n">increment</span><span class="p">(</span><span class="kt">atomic_int</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tmp</span><span class="p">;</span>
<span class="w">    </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">tmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">v</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">tmp</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">compare_and_swap</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="p">,</span><span class="w"> </span><span class="n">tmp</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>ä½¿ç”¨ atomic variables åå®é™…ä¸Šå°±<strong>ä¸å¤ªç¬¦åˆ CS é—®é¢˜çš„æ¨¡å‹</strong>äº†ï¼Œå¯ä»¥å‘ç°ï¼Œè¿™é‡Œå¹¶ä¸å†éœ€è¦ç»´æŠ¤ç±»ä¼¼ <code>LOCK</code> çš„ä¸œè¥¿ï¼Œè€Œæ˜¯ä»¥ <code>*target</code> æ˜¯å¦ç¬¦åˆ <code>expected</code> çš„é¢„è®¾æ¥åˆ¤æ–­æ˜¯å¦æœ‰ç«äº‰å‡ºç°ï¼Œä½œä¸ºä¸€ä¸ªåŒæ­¥å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™ç§å°è£…åçš„åŸå­æ€§æ“ä½œæ¥è§£å†³ race conditionï¼Œè€Œä¸éœ€è¦å†åŒºåˆ† entry section æˆ–æ˜¯ critical section ç­‰ã€‚</p>
<blockquote>
<p>ä¹¦æœ¬ä¸Šç‰¹åœ°æåˆ°ï¼Œåœ¨ä¾‹å¦‚ <a href="../Unit2-Part2/#the-bounded-buffer-problem" target="_blank">producer&amp;consumer</a> çš„æ¨¡å‹ä¸­ï¼Œä½¿ç”¨ atomic variables ç»´æŠ¤ count å¹¶ä¸èƒ½è§£å†³ race conditionï¼Œä½†æˆ‘è®¤ä¸ºè¿™ç§è®¨è®ºæ˜¯æœ‰å¤±åé¢‡çš„ï¼Œæ‰€è°“çš„â€œåŸå­æ€§â€åº”è¯¥åŒ…æ‹¬æ‰€æœ‰æ“ä½œä¸´ç•Œèµ„æºçš„éƒ¨åˆ†ï¼Œä¹¦ä¸­åªç»´æŠ¤ count ä¸ç»´æŠ¤ buffer çš„å‡è®¾æˆ‘è§‰å¾—å¯¹äº atomic è¿™ä¸ªæ¦‚å¿µæ¥è¯´å®åœ¨ä¸å¤Ÿå…¬å¹³ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿™é‡Œå°±ä¸ç€é‡è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚</p>
</blockquote>
<h2 id="mutex-locks">Mutex Locks<a class="headerlink" href="#mutex-locks" title="Permanent link">Â¶</a></h2>
<p>ç”±æ­¤æˆ‘ä»¬å·²ç»å¾—åˆ°äº†èƒ½åœ¨ç¡¬ä»¶å±‚é¢è§£å†³ race condition é—®é¢˜çš„æ ¹æºçš„å·¥å…·äº†ï¼Œä½†æ˜¯ä¸ºäº†èƒ½è®©ç”¨æˆ·ç¨‹åºä¹Ÿèƒ½æ›´å¥½çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒåšä¸€æ¬¡è½¯ä»¶å±‚é¢çš„å°è£…ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬è®¾è®¡äº†<strong>äº’æ–¥é”(mutex locks)</strong>è¿™ä¸ªä¸œè¥¿ã€‚</p>
<p>åˆ©ç”¨äº’æ–¥é”é¿å… race condition çš„åŸºæœ¬æ€è·¯ä»ç„¶æ˜¯åŸºäº CS é—®é¢˜çš„å»ºæ¨¡ï¼Œä½†å®ƒæ›´å…·ä½“åœ°è®¤ä¸ºåœ¨ entry section å°±è¯¥å»ç´¢å–äº’æ–¥é”ï¼Œè€Œåœ¨ exit section å°±åº”è¯¥å»é‡Šæ”¾äº’æ–¥é”ï¼Œå³ï¼š</p>
<div class="highlight"><pre><span></span><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Acquire Lock       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Critical Section   â”‚ &lt;-- codes manipulating critical resources
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Release Lock       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Remainder Section  â”‚ &lt;-- other codes
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>
<p>å›é¡¾æˆ‘ä»¬åœ¨ä»‹ç» <a href="#test_and_set" target="_blank"><code>test_and_set()</code></a> éƒ¨åˆ†ç»™å‡ºçš„è¿™æ®µä»£ç ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">test_and_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">LOCK</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w">    </span><span class="c1">// - entry section</span>
</span>
<span class="w">    </span><span class="cm">/* operate critical resources */</span><span class="w">    </span><span class="c1">// - critical section</span>

<span class="hll"><span class="w">    </span><span class="n">LOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w">                       </span><span class="c1">// - exit section</span>
</span>
<span class="w">    </span><span class="cm">/* other things */</span><span class="w">                  </span><span class="c1">// - remainder section</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>æˆ‘ä»¬åªéœ€è¦å°†é«˜äº®çš„è¿™ä¸¤è¡Œå°è£…èµ·æ¥ï¼Œå°±å®ç°äº† acquire LOCK å’Œ release LOCKã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1">// `available` means whether the `LOCK` is free, or whether the related </span>
<span class="c1">// resources is available</span>
<span class="n">acquire</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">!</span><span class="n">compare_and_swap</span><span class="p">(</span><span class="o">&amp;</span><span class="n">available</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{}</span>
<span class="p">}</span>

<span class="n">release</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">available</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬åœ¨ <a href="#test_and_set" target="_blank"><code>test_and_set()</code></a> è®¨è®ºä¸Šé¢é‚£æ®µä»£ç çš„æ—¶å€™ï¼Œè®¨è®ºè¿‡å®ƒæ— æ³•æ»¡è¶³ bounded waiting time çš„é—®é¢˜ï¼Œé‚£æ—¢ç„¶å¦‚æ­¤æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸æŠŠ <code>WAITING[]</code> ä¹Ÿä¸€èµ·å°è¿›å»å‘¢ï¼Ÿ</p>
<p>è¿™æ˜¯å› ä¸ºä¹¦ä¸Šç›´æ¥å¿½ç•¥äº†è¿™ä¸ªé—®é¢˜ï¼Œç›´åˆ°åœ¨ä¹‹åè®² <a href="#semaphores" target="_blank">semaphores</a> çš„æ—¶å€™æ‰æƒ³èµ·æ¥ï¼Œä½† semaphores å’Œ mutex lock åˆæ˜¯ä¸¤ä¸ªè·¯å­ï¼Œæˆ‘ä¹Ÿä¸çŸ¥é“å®ƒåˆ°åº•æƒ³è¯´æ˜ä»€ä¹ˆé—®é¢˜ã€‚ä½†æ˜¯æ—¢ç„¶å®ƒç°åœ¨å¿½ç•¥äº†ï¼Œæˆ‘ä»¬å°±å…ˆä¸ç®¡å®ƒï¼Œä½†æ˜¯æˆ‘å¸Œæœ›è¯»è€…èƒ½æ„è¯†åˆ°è¿™ä¸ªé—®é¢˜æ˜¯å­˜åœ¨çš„ã€‚</p>
</blockquote>
<p>ç»è¿‡è¿™ä¹ˆé•¿çš„é“ºå«ï¼Œæˆ‘ä»¬ç°åœ¨èƒ½å¤Ÿä¿è¯çš„ä¸€ä»¶äº‹æ˜¯ï¼Œæˆ‘ä»¬ç»ˆäºå¾—åˆ°äº†ä¸€ä¸ªè½¯ä»¶å±‚é¢çš„ã€èƒ½å¤Ÿé¿å… race condition çš„åŒæ­¥å·¥å…·ã€‚é‚£ä¹ˆå®ç°åŸºæœ¬éœ€æ±‚ä»¥åæˆ‘ä»¬å°±å¼€å§‹è€ƒè™‘èƒ½ä¸èƒ½ä¼˜åŒ–å®ƒã€‚</p>
<h3 id="å¿™ç­‰å¾…">å¿™ç­‰å¾…<a class="headerlink" href="#å¿™ç­‰å¾…" title="Permanent link">Â¶</a></h3>
<p>å¦‚æœè¯»è€…å¯¹ä»£ç æœ‰æ¯”è¾ƒæ•æ„Ÿçš„å—…è§‰ï¼Œé‚£å¯èƒ½çœ‹è¿™å‡ åƒä¸ªå­—åˆ°ç°åœ¨ï¼Œä½ å·²ç»ä¸ºæ•°ä¸æ¸…çš„ <code>while()</code> æå¿ƒåŠèƒ†è¿‡åå¤šæ¬¡äº†ã€‚æ²¡é”™ï¼Œè™½ç„¶æˆ‘ä»¬é€šè¿‡é€»è¾‘ä¿è¯è¿™é‡Œä¸ä¼šå‡ºç°æ­»å¾ªç¯ï¼Œä½†å¯¹äºç­‰å¾…ä¸­çš„ processï¼Œç¡®å®è¦åœ¨æ•°ä¸å°½çš„ <code>while</code> loop ä¸­æµªè´¹ CPUï¼Œæˆ‘ä»¬ç§°è¿™ç§ç­‰å¾…é”é‡Šæ”¾çš„è¡Œä¸ºä¸º<strong>å¿™ç­‰å¾…(busy waiting)</strong>ï¼Œå…¶ä¸­â€œå¿™â€æŒ‡çš„å°±æ˜¯åœ¨ç­‰å¾…è¿‡ç¨‹ä¸­ä»ç„¶å ç”¨ CPU èµ„æºã€‚è€Œè¿™ç§ä½¿ç”¨å¿™ç­‰å¾…çš„äº’æ–¥é”ï¼Œä¹Ÿè¢«ç§°ä¸º<strong><a href="https://en.wikipedia.org/wiki/Spinlock" target="_blank">è‡ªæ—‹é”(spinlock)</a></strong>ã€‚</p>
<p>æˆ‘ä»¬å¼•å…¥ä¸¤ä¸ªè¯æ¥æ›´å‡†ç¡®çš„æè¿°è¿™ä»¶äº‹ï¼š</p>
<div class="admonition definition">
<p class="admonition-title">Lock Contention</p>
<p>å¦‚æœä¸€ä¸ªç”¨æˆ·è¯•å›¾ç´¢å–æŸä¸ªé”æ—¶ï¼Œå¦‚æœè¿™ä¸ªé”ä¸æ˜¯ available çš„ï¼Œè¿™å°±æ„å‘³ç€æœ‰ç”¨æˆ·æ­£åœ¨ä½¿ç”¨è¿™ä¸ªé”ï¼Œè€Œå½“å‰ç”¨æˆ·éœ€è¦ç­‰å¾…è¿™ä¸ªé”é‡æ–°å¯ç”¨ï¼Œæ­¤æ—¶æˆ‘ä»¬ç§°è¿™ä¸ªé”æ˜¯<strong>è¢«äº‰æŠ¢çš„(contended)</strong>ï¼›åä¹‹ï¼Œå¦‚æœä¸å­˜åœ¨äº‰æŠ¢ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºä¸è¢«äº‰æŠ¢çš„(uncontended)ã€‚</p>
<p>å¦‚æœç°åœ¨æœ‰å¥½å¤šç”¨æˆ·éƒ½åœ¨äº‰æŠ¢ä¸€ä¸ªé”ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º high contentionï¼›åä¹‹å¦‚æœåªæœ‰é›¶æ˜Ÿå‡ ä¸ªç”¨æˆ·åœ¨äº‰æŠ¢è¿™ä¸ªé”ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º low contentionã€‚</p>
<p>å¦‚æœå»¶ç”¨ spinlockï¼Œé‚£ä¹ˆä¸éš¾å¾—åˆ°ç»“è®ºï¼šhigh contention ä¼šå¯¼è‡´ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºæ€»æ˜¯ä¼šæœ‰å¤§é‡å¾—ä¸åˆ°é”çš„ç”¨æˆ·å¤„äº busy waiting ä¸­ã€‚</p>
</div>
<p>æ—¢ç„¶å®ƒä»¬éƒ½æ˜¯åœ¨åšæ— æ„ä¹‰çš„ç­‰å¾…ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸åœ¨è¿™ä¸ªæ—¶å€™æŠŠèµ„æºè®©ç»™æœ‰éœ€è¦çš„äººå‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æš‚æ—¶åœ°åˆ‡æ¢è¿›ç¨‹ï¼Œè®©è¿™äº›å¤„äºç­‰å¾…çš„ç”¨æˆ·æš‚æ—¶ä¼‘çœ ï¼Œç­‰æ—¶æœºåˆ°æ¥å†å”¤é†’å®ƒä»¬ï¼Œæ­¤æ—¶å°±éœ€è¦ç³»ç»Ÿè°ƒç”¨çš„ä»‹å…¥<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup>ã€‚è€Œå…·ä½“çš„æ–¹æ³•æˆ‘ä»¬åœ¨ä¸‹ä¸€èŠ‚çš„<a href="#é¿å…å¿™ç­‰å¾…" target="_blank">é¿å…å¿™ç­‰å¾…</a>ä¸­ä»‹ç»ã€‚</p>
<p><strong>ä½†æ˜¯</strong>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œéœ€è¦ä¿æŒå®¢è§‚ï¼šspinlock åœ¨ç‰¹å®šæƒ…å†µä¸‹æ˜¯æœ‰å¥½å¤„çš„ï¼Œåœ¨ç­‰å¾…æ—¶é—´å¹¶ä¸é•¿çš„æƒ…å†µä¸‹ï¼Œç›¸æ¯”äºæ‹¥æœ‰é”çš„ç”¨æˆ·é‡Šæ”¾é”ï¼Œè¿›è¡Œè°ƒåº¦é”éœ€è¦çš„ context switch çš„å¼€é”€å¯èƒ½æ˜¾å¾—è¾ƒå¤§ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬è¿˜æ²¡æ¥å¾—åŠæŠŠèµ„æºè®©ç»™åˆ«äººé”å°±å¥½äº†ï¼Œé‚£ä¹ˆè¿™ç§èµ„æºè½¬è®©è¿˜ä¸å¦‚ä¸è½¬ã€‚è€Œäº‹å®ä¸Šï¼Œåœ¨ç‰¹å®šæƒ…å†µä¸‹ï¼Œè‡ªæ—‹é”ä¹Ÿç¡®å®æ˜¯ä¸€äº›å¤šæ ¸ç³»ç»Ÿçš„é¦–é€‰ã€‚</p>
<p>ä¸è¿‡åœ¨è®¸å¤šè¯­å¢ƒé‡Œ mutex å’Œ spinlock æ˜¯è¢«åŒºåˆ†å¼€æ¥çš„ä¸¤ä¸ªæ¦‚å¿µï¼Œå…·ä½“ä½¿ç”¨å“ªä¸ªåˆ™éœ€è¦é€‚æ—¶åˆ¤æ–­<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>ã€‚</p>
<h2 id="semaphores">Semaphores<a class="headerlink" href="#semaphores" title="Permanent link">Â¶</a></h2>
<div class="admonition quote">
<p class="admonition-title">Links</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Semaphore_(programming)" target="_blank">Wikipedia</a></li>
</ul>
</div>
<p>Mutex lock ä¸ºç”¨æˆ·ç¨‹åºæä¾›äº†ç±»ä¼¼äºâ€œæˆ¿é—´ç”³è¯·â€çš„åŠŸèƒ½ï¼Œé”ç«äº‰å°±å¥½åƒå¤§å®¶æŠ¢æˆ¿é—´çš„ä½¿ç”¨æƒã€‚è€Œ<strong>ä¿¡å·é‡(semaphores)</strong>åˆ™æ˜¯ç±»ä¼¼äºæˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡çš„ <a href="#atomic-variables" target="_blank">atomic variables</a>ï¼Œé€šè¿‡æä¾›æ ‡å‡†åŒ–çš„åŸå­æ€§æ“ä½œï¼Œæ¥ç»´æŠ¤ä¸€äº›å˜é‡ï¼Œåªä¸è¿‡å®ƒé¢å¤–å¯¹å˜é‡çš„å€¼æœ‰ä¸€å®šçš„çº¦æŸã€‚</p>
<p><del>ï¼ˆè¯´å®è¯æˆ‘æ„Ÿè§‰è¿™ä¿©ä¸œè¥¿æœ¬è´¨ä¸ŠçœŸæ²¡å•¥åŒºåˆ«â€¦â€¦ï¼‰</del></p>
<p>Semaphores åªæä¾›ä¸¤ä¸ªæ ‡å‡†åŒ–çš„æ¥å£ï¼š<code>wait()</code>ï¼ˆæˆ–<code>P()</code>ï¼‰ å’Œ <code>signal()</code>ï¼ˆæˆ–<code>V()</code>ï¼‰ï¼Œå®ƒä»¬çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&lt;</span><span class="n">atomic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">wait</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="c1">// busy wait here</span>
<span class="w">    </span><span class="n">S</span><span class="o">--</span><span class="p">;</span>
<span class="p">}</span>

<span class="o">&lt;</span><span class="n">atomic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signal</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">S</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>æ˜¾ç„¶ï¼Œè¿™ä¸¤ä¸ªæ“ä½œçš„å®ç°ä¹Ÿåº”å½“ä¿è¯æ˜¯ atomic çš„ã€‚</p>
<p>åŒºåˆ«äºæ™®é€šçš„ atomic variablesï¼Œsemaphores å¤šäº†åœ¨ç¬¬ 2 è¡Œçš„ busy waitï¼Œè¿™æš—å«äº†ä¸€ç§â€œæœ‰é™â€çš„æ¦‚å¿µï¼Œå³ä¿è¯ <span class="arithmatex">\(0 \leq S\)</span>ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œsemaphores åˆ†ä¸º counting semaphore å’Œ binary semaphoreï¼Œå‰è€…çš„åŠŸèƒ½å¦‚ä¸Šï¼Œåè€…åªä¸è¿‡æ˜¯é¢å¤–è¦æ±‚ <span class="arithmatex">\(0 \leq S \leq 1\)</span>ï¼Œä¿®æ”¹ loop çš„æ¡ä»¶å³å¯ã€‚</p>
<h3 id="ä½¿ç”¨">ä½¿ç”¨<a class="headerlink" href="#ä½¿ç”¨" title="Permanent link">Â¶</a></h3>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹æ–¹å¼ï¼Œä¿è¯ <code>P0()</code> ä¸­çš„ section A å¿…é¡»åœ¨ <code>P1()</code> çš„ section B ä¹‹å‰å®Œæˆï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">semaphore</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="n">P0</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="cm">/* Section A */</span>
<span class="w">    </span><span class="n">signal</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">P1</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wait</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* Section B */</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ä¸Šé¢çš„ä¾‹å­éå¸¸å½¢è±¡åœ°å±•ç¤ºäº†ä¿¡å·é‡æ˜¯å¦‚ä½•å‘æŒ¥ä½œç”¨çš„ï¼Œå½“ç„¶ï¼Œä¸Šé¢åªå±•ç¤ºäº†ç±»ä¼¼<strong>è¿›ç¨‹é—´é€šè®¯</strong>çš„åŠŸèƒ½ï¼Œä¸‹é¢è¿™ä¸ªå½¢å¼åˆ™æ›´æ¥è¿‘æˆ‘ä»¬ä¸Šæ–‡ä¸­è®¨è®ºçš„æƒ…å†µï¼Œå³å®ç°äº†<strong>äº’æ–¥</strong>ï¼š</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// `i` is process id and S is the semaphores</span>
<span class="n">process</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">wait</span><span class="p">(</span><span class="n">S</span><span class="p">);</span><span class="w">    </span><span class="c1">// i.e. release the 'LOCK'</span>

<span class="w">    </span><span class="cm">/* critical section */</span>

<span class="w">    </span><span class="n">signal</span><span class="p">(</span><span class="n">S</span><span class="p">);</span><span class="w">  </span><span class="c1">// only one process can pass this line at once</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<h3 id="é¿å…å¿™ç­‰å¾…">é¿å…å¿™ç­‰å¾…<a class="headerlink" href="#é¿å…å¿™ç­‰å¾…" title="Permanent link">Â¶</a></h3>
<p>æˆ‘ä»¬åœ¨ mutex ä¸­æå‡º<a href="#å¿™ç­‰å¾…" target="_blank">å¿™ç­‰å¾…</a>çš„æ—¶å€™å°±å·²ç»æåˆ°è¿‡ï¼Œå¯ä»¥é€šè¿‡ã€Œåœ¨ç­‰å¾…çš„æ—¶å€™è®©è¿›ç¨‹ä¼‘çœ ï¼Œç­‰æ—¶æœºåˆé€‚çš„æ—¶å€™å†å”¤é†’ã€çš„æ–¹å¼ï¼Œæ¥å‡å°<strong>è¾ƒé•¿çš„</strong>å¿™ç­‰å¾…å¼•èµ·çš„æ€§èƒ½é™ä½ã€‚è€Œä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦æ‰©å±• semaphores çš„å†…å®¹ï¼Œå¼•å…¥ä¸€ä¸ªé“¾è¡¨æ¥ç»´æŠ¤ç­‰å¾…ä¸­çš„è¿›ç¨‹ã€‚</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">struct</span><span class="w"> </span><span class="nc">semaphore</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="n">waiting_list</span><span class="p">;</span>
<span class="p">};</span>

<span class="o">&lt;</span><span class="n">atomic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">wait</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="o">--</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">S</span><span class="o">-&gt;</span><span class="n">waiting_list</span><span class="p">.</span><span class="n">push</span><span class="p">(</span><span class="n">current</span><span class="w"> </span><span class="n">process</span><span class="p">);</span>
<span class="w">        </span><span class="n">sleep</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="o">&lt;</span><span class="n">atomic</span><span class="o">&gt;</span><span class="w"> </span><span class="n">signal</span><span class="p">(</span><span class="n">reference</span><span class="w"> </span><span class="n">S</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">S</span><span class="o">-&gt;</span><span class="n">waiting_list</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
<span class="w">        </span><span class="n">wakeup</span><span class="p">(</span><span class="n">p</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>ç›¸æ¯”äºä¹‹å‰çš„é€»è¾‘ï¼Œç°åœ¨çš„é€»è¾‘ç¨å¾®æœ‰ç‚¹å˜åŒ–ï¼Œè¯·è¯»è€…å°è¯•ç‹¬ç«‹åˆ†æå…¶ä¸­çš„å¥¥ç§˜ã€‚è¿™é‡Œæ˜¯ä¸€äº›æç¤ºï¼š</p>
<div class="admonition tip">
<p class="admonition-title">å¤´è„‘é£æš´</p>
<p>è¯·è¯»è€…æ€è€ƒï¼š</p>
<ol>
<li>ç°åœ¨å·²ç»æ²¡æœ‰ <code>while</code> äº†ï¼Œåªä½™ä¸‹ <code>if</code>ï¼Œç°åœ¨æ˜¯å¦‚ä½•ä¿è¯ç­‰å¾…ä¸­çš„è¿›ç¨‹èƒ½å¤Ÿè¢«åŠæ—¶å”¤é†’ï¼Ÿ</li>
<li><code>wait</code> åŸå…ˆæ˜¯å…ˆç­‰å¾…å†ä¿®æ”¹ï¼Œç°åœ¨æ˜¯å…ˆä¿®æ”¹ã€å†ç­‰å¾…ï¼Œè¿™å¯¹æ•´ä½“é€»è¾‘æœ‰ä½•å½±å“ï¼Ÿ</li>
<li><code>signal</code> ä¸­çš„æ¡ä»¶è¯­å¥ï¼Œä¸ºä½•æ˜¯ <code class="highlight"><span class="n">S</span><span class="o">-&gt;</span><span class="n">value</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span></code>ï¼Ÿè¿™ä¸ªæ¡ä»¶ä¸º false æ—¶æ„å‘³ç€ä»€ä¹ˆï¼Ÿ<ul>
<li>è€ƒè™‘åœ¨ high contention çš„æƒ…å†µä¸‹ï¼Œèµ„æºæ€»æ˜¯ä¸€å‡ºç°å°±è¢«æŠ¢ç©ºã€‚</li>
</ul>
</li>
</ol>
</div>
<p>è€Œå®é™…ä¸Šï¼Œç°åœ¨æˆ‘ä»¬æåˆ°ä¿¡å·é‡ï¼Œé»˜è®¤æŒ‡çš„å°±æ˜¯<a href="#é¿å…å¿™ç­‰å¾…" target="_blank">é¿å…å¿™ç­‰å¾…</a>è¿™ä¸€èŠ‚ä¸­æåˆ°çš„è¿™ç§ã€‚</p>
<div class="footnote">
<hr/>
<ol>
<li id="fn:1">
<p><a href="https://crystal.uta.edu/~ylei/cse6324/data/critical-section.pdf" target="_blank">The Critical Section Problem</a>Â <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">â†©</a></p>
</li>
<li id="fn:2">
<p>ä¹¦æœ¬ä¸­å¯¹ preemptive kernels å’Œ non-preemptive kernels çš„å®šä¹‰å¹¶ä¸å‡†ç¡®ï¼Œä¸¤è€…æœ€æœ¬è´¨çš„åŒºåˆ«æ˜¯åè€…å®ç°äº† <a href="https://en.wikipedia.org/wiki/Giant_LOCK" target="_blank">Giant Lock</a>ã€‚åŒæ—¶è¯»è€…å¯ä»¥å‚è€ƒè¿™ä¸ªé“¾æ¥ï¼š<a href="https://unix.stackexchange.com/questions/412806/what-was-the-reason-of-the-non-preemptivity-of-older-linux-kernels" target="_blank">What was the reason of the non-preemptivity of older Linux kernels? | Stack Exchange</a>Â <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">â†©</a></p>
</li>
<li id="fn:3">
<p><a href="https://stackoverflow.com/a/7068027/22331129" target="_blank">Mutex access and system call | Stack Overflow</a>Â <a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">â†©</a></p>
</li>
<li id="fn:4">
<p>â­ï¸ <a href="https://stackoverflow.com/a/5870415/22331129" target="_blank">When should one use a spinlock instead of mutex? | Stack Overflow</a>Â <a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">â†©</a></p>
</li>
</ol>
</div>
<hr/>
<div class="md-source-file">
<small>
    
      æœ€åæ›´æ–°:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2024å¹´1æœˆ13æ—¥ 19:00:24</span>
<br/>
        åˆ›å»ºæ—¥æœŸ:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">2024å¹´1æœˆ13æ—¥ 19:00:24</span>
</small>
</div>
<form class="md-feedback" hidden="" name="feedback">
<fieldset>
<legend class="md-feedback__title">
        æ¿€åŠ±
      </legend>
<div class="md-feedback__inner">
<div class="md-feedback__list">
<button class="md-feedback__icon md-icon" data-md-value="1" title="æ¿€åŠ±" type="submit">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M377.1 68.05C364.4 50.65 343.7 40 321.2 40h-13.53c-3.518 0-7.039.275-10.53.818C284.8 31.33 269.6 26 253.5 26H240c-3.977 0-7.904.37-11.75 1.084C216.7 10.71 197.6 0 176 0h-16c-35.3 0-64 28.65-64 64v49.71L63.04 143.3C43.3 160 32 184.6 32 210.9v78.97c0 32.1 17.11 61.65 44.65 77.12L112 386.9V488c0 13.3 10.7 24 23.1 24s24.9-10.7 24.9-24V358.1c-1.316-.654-2.775-.92-4.062-1.639l-55.78-31.34C87.72 318.2 80 304.6 80 289.9v-79c0-12.31 5.281-23.77 14.5-31.39L112 163.8V208c0 8.8 7.2 16 16 16s16-7.156 16-16V64c0-8.828 7.188-16 16-16h16c8.8 0 16 7.17 16 16v16c0 9.578 7.942 16.04 16.15 16.04 6.432 0 12.31-4.018 14.73-10.17C223.3 84.84 228.3 74 240 74h13.53c20.97 0 17.92 19.58 34.27 19.58 8.177 0 9.9-5.584 19.88-5.584h13.53c25.54 0 18.27 28.23 38.66 28.23.156 0 .313-.002.467-.008L375.4 116c12.7 0 24.6 11.7 24.6 26v130c0 36.15-19.54 67.32-48 83.69v132.3c0 13.31 10.7 24.01 23.1 24.01s24.9-10.7 24.9-24V379.9c30.1-27.1 48-66.3 48-107.9V142c0-39.9-31.2-72.56-70.9-73.95z"></path></svg>
</button>
</div>
<div class="md-feedback__note">
<div data-md-value="1" hidden="">
<center> éš¾é“è¯´â€¦â€¦ä½ æ„¿æ„ç»™æˆ‘ä¹°ä¸€ç“¶å¿«ä¹æ°´å—ï¼ğŸ«£ </center> <img src="https://s2.loli.net/2023/08/03/EGbIvMQXalKTsUi.png" width="200px"/>
</div>
</div>
</div>
</fieldset>
</form>
<h2 id="__comments">è¯„è®º</h2>
<!-- Insert generated snippet here -->
<script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOIVXFKs4CSVPj" data-emit-metadata="0" data-input-position="top" data-lang="zh-CN" data-mapping="pathname" data-reactions-enabled="1" data-repo="IsshikiHugh/notebook" data-repo-id="R_kgDOIVXFKg" data-strict="0" data-theme="light" src="https://giscus.app/client.js">
</script>
<!-- Synchronize Giscus theme with palette -->
<script>
    var giscus = document.querySelector("script[src*=giscus]")

    /* Set palette on initial load */
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = "light"
      giscus.setAttribute("data-theme", theme) 
    }

    /* Register event handlers after documented loaded */
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = "light"

          /* Instruct Giscus to change theme */
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" hidden="" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
            å›åˆ°é¡µé¢é¡¶éƒ¨
          </a>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
<div class="md-copyright__highlight">
      Copyright Â© 2022 Isshikiä¿®
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/IsshikiHugh" rel="noopener" target="_blank" title="Github">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.annotate", "content.code.copy", "navigation.tracking", "navigation.tabs", "navigation.indexes", "navigation.top", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
<script src="../../../assets/javascripts/bundle.4b2c34cd.min.js"></script>
<script src="../../../_js/extra.js"></script>
<script src="../../../_js/katex.js"></script>
<script src="https://jsd.cdn.zzko.cn/npm/katex@0.16.4/dist/katex.min.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body>
</html>